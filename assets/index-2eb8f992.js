var ie=Object.defineProperty;var re=(t,a,i)=>a in t?ie(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i;var D=(t,a,i)=>(re(t,typeof a!="symbol"?a+"":a,i),i);import{r as u,a as se,R as V}from"./vendor-b1791c80.js";import{u as ne,Q as oe,a as $}from"./query-0b6e7572.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=i(s);fetch(s.href,n)}})();var q={exports:{}},k={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ce=u,le=Symbol.for("react.element"),de=Symbol.for("react.fragment"),ue=Object.prototype.hasOwnProperty,me=ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,he={key:!0,ref:!0,__self:!0,__source:!0};function U(t,a,i){var r,s={},n=null,o=null;i!==void 0&&(n=""+i),a.key!==void 0&&(n=""+a.key),a.ref!==void 0&&(o=a.ref);for(r in a)ue.call(a,r)&&!he.hasOwnProperty(r)&&(s[r]=a[r]);if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:le,type:t,key:n,ref:o,props:s,_owner:me.current}}k.Fragment=de;k.jsx=U;k.jsxs=U;q.exports=k;var e=q.exports,N={},B=se;N.createRoot=B.createRoot,N.hydrateRoot=B.hydrateRoot;const W=u.createContext(void 0);function ge({api:t,state:a,children:i}){const r={api:t,state:a,credentials:{database:(a==null?void 0:a.database)||"demo",userName:(a==null?void 0:a.userName)||"user@example.com",sessionId:(a==null?void 0:a.sessionId)||"mock-session"}};return e.jsx(W.Provider,{value:r,children:i})}function M(){const t=u.useContext(W);if(!t)throw new Error("useAddInContext must be used within AddInProvider");return t}function pe(t,a){return a.every(i=>t.includes(i))}function ve(t,a){return a.filter(i=>!t.includes(i))}function _e(){const{api:t,state:a}=M(),i=u.useMemo(()=>["ViewCollisionRisk","ViewExceptions","ViewDrivers","ViewMaintenanceWorkOrders","ViewMaintenanceWorkRequests","ViewFaults","ViewMaintenanceOverview","ViewHoSLogs","ViewDutyStatusViolations","ViewIftaMiles"],[t,a]);return{userPermissions:i,hasPermissions:n=>pe(i,n),missingPermissions:n=>ve(i,n)}}const fe="safety-scorecard",be="Safety Scorecard",xe="Monitor fleet safety performance with collision risk, exceptions, and driver rankings",ye="safety",we="IconShield",je=53334,Ne=["safety","risk","exceptions","drivers","AI"],ke=["ViewCollisionRisk","ViewExceptions","ViewDrivers"],Se=[{id:"collision-risk-overview",type:"overview-card",title:"Average Collision Risk Score",description:"Fleet-wide collision risk based on AI model",icon:"IconAlert",dataSource:{apiEntity:"CollisionRiskAnalytics",aggregationParams:{groupBy:["database"],aggregations:[{op:"avg",field:"score",alias:"avgScore"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:0,width:4},configurable:!1,required:!0,options:{trendConfig:{comparisonPeriod:"7d",showPercentage:!0,showArrow:!0}}},{id:"safety-alerts",type:"immediate-actions",title:"Safety Alerts",description:"Critical safety items requiring attention",icon:"IconWarning",dataSource:{apiEntity:"ExceptionEvent",filters:[{field:"severity",operator:"IN",value:["Critical","High"]}],dateRangeEnabled:!0,groupFilterEnabled:!0,resultsLimit:100},defaultPosition:{row:1,column:0,width:12},configurable:!1,required:!0,options:{navigationConfig:[{id:"critical-exceptions",label:"Critical Exceptions",pageName:"exception",pageState:{severity:["Critical"]}},{id:"high-risk-drivers",label:"High-Risk Drivers",pageName:"riskManagement",pageState:{sortBy:"riskScore",sortDirection:"desc"}}]}},{id:"collision-risk-benchmark",type:"benchmark-bar",title:"Collision Risk vs Industry",description:"Compare your fleet's risk score to industry average",icon:"IconTrendingUp",dataSource:{apiEntity:"CollisionRiskAnalytics",aggregationParams:{aggregations:[{op:"avg",field:"score"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:4,width:4},configurable:!1,options:{benchmarkValue:65}},{id:"safety-metrics-trend",type:"metric-chart",title:"Safety Metrics",description:"Track safety performance over time",icon:"IconChartLine",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*",alias:"exceptionCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"statusDate",sortDirection:"asc"}},defaultPosition:{row:2,column:0,width:12},configurable:!0,options:{availableMetrics:[{id:"exception-count",label:"Exception Count",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"harsh-events",label:"Harsh Events",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*"}]},filters:[{field:"rule.name",operator:"IN",value:["Harsh Braking","Harsh Acceleration","Harsh Cornering"]}],dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"collision-risk-score",label:"Collision Risk Score",dataSource:{apiEntity:"CollisionRiskAnalytics",aggregationParams:{groupBy:["dateCalculated"],aggregations:[{op:"avg",field:"score"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}}]}},{id:"highest-risk-drivers",type:"performance-rankings",title:"Highest Risk Drivers",description:"Drivers with most safety exceptions",icon:"IconUser",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"exceptionCount"},{op:"sum",field:"severity",alias:"totalSeverity"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"totalSeverity",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:0,column:8,width:4},configurable:!0,options:{rankingLimit:10}}],Ee=[{id:"exception-types-breakdown",type:"overview-card",title:"Exception Types",description:"Breakdown of exceptions by type",icon:"IconPieChart",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["rule.name"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:3,column:0,width:6},configurable:!0},{id:"safest-drivers",type:"performance-rankings",title:"Safest Drivers",description:"Drivers with fewest exceptions",icon:"IconTrophy",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"exceptionCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"exceptionCount",sortDirection:"asc"},resultsLimit:10},defaultPosition:{row:3,column:6,width:6},configurable:!0,options:{rankingLimit:10}}],Ce={id:fe,name:be,description:xe,category:ye,icon:we,estimatedUsers:je,tags:Ne,requiredPermissions:ke,defaultModules:Se,availableModules:Ee},De="maintenance-overview",Pe="Maintenance Overview",Me="Track maintenance operations, predict breakdowns, and manage work orders",Re="maintenance",Le="IconTool",Ie=68977,Ae=["maintenance","work orders","faults","downtime","predictive"],Be=["ViewMaintenanceWorkOrders","ViewMaintenanceWorkRequests","ViewFaults","ViewMaintenanceOverview"],Oe=[{id:"immediate-actions",type:"immediate-actions",title:"Immediate Actions",description:"Critical maintenance items requiring attention",icon:"IconAlert",dataSource:{apiEntity:"MaintenanceWorkRequestEntity",filters:[],dateRangeEnabled:!0,groupFilterEnabled:!0,resultsLimit:100},defaultPosition:{row:0,column:0,width:12},configurable:!1,required:!0,options:{navigationConfig:[{id:"severe-work-requests",label:"Severe Work Requests",pageName:"maintenanceWorkRequests",pageState:{severities:["Critical","High"],isReviewed:!1}},{id:"severe-faults",label:"Severe Faults (Last 7 Days)",pageName:"faults",pageState:{severities:["Critical","High"],daysBack:7}},{id:"extended-downtime",label:"Vehicles with Extended Downtime",pageName:"vehicleDowntime",pageState:{minDays:14}}]}},{id:"maintenance-metrics",type:"metric-chart",title:"Maintenance Metrics",description:"Track maintenance performance over time",icon:"IconChartLine",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["completedDate"],aggregations:[{op:"count",field:"*",alias:"workOrderCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"completedDate",sortDirection:"asc"}},defaultPosition:{row:1,column:0,width:12},configurable:!0,options:{availableMetrics:[{id:"work-orders-completed",label:"Work Orders Completed",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["completedDate"],aggregations:[{op:"count",field:"*"}]},filters:[{field:"status",operator:"IN",value:["Closed","Completed"]}],dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"work-requests-created",label:"Work Requests Created",dataSource:{apiEntity:"MaintenanceWorkRequestEntity",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"breakdown-rate",label:"Breakdown Rate",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"downtime-hours",label:"Downtime Hours",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["date"],aggregations:[{op:"sum",field:"downtimeSeconds"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}}]}},{id:"highest-risk-breakdown",type:"performance-rankings",title:"Highest Risk of Breakdown",description:"Assets most likely to break down",icon:"IconWarning",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["device"],aggregations:[{op:"count",field:"*",alias:"breakdownCount"},{op:"sum",field:"downtimeSeconds",alias:"totalDowntime"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"breakdownCount",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:2,column:0,width:6},configurable:!0,options:{rankingLimit:10}},{id:"performance-insights",type:"performance-rankings",title:"Performance Insights",description:"Asset and group maintenance performance",icon:"IconChartBar",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["device"],aggregations:[{op:"count",field:"*",alias:"workOrderCount"},{op:"sum",field:"totalCosts",alias:"totalCost"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"workOrderCount",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:2,column:6,width:6},configurable:!0,options:{rankingLimit:10}}],Fe=[{id:"total-work-orders",type:"overview-card",title:"Total Work Orders",description:"Work orders completed this period",icon:"IconClipboard",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["database"],aggregations:[{op:"count",field:"*",alias:"totalCount"}]},filters:[{field:"status",operator:"IN",value:["Closed","Completed"]}],dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:0,width:4},configurable:!0,options:{trendConfig:{comparisonPeriod:"30d",showPercentage:!0,showArrow:!0}}},{id:"average-downtime",type:"overview-card",title:"Average Downtime",description:"Average downtime per vehicle",icon:"IconClock",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["database"],aggregations:[{op:"avg",field:"downtimeSeconds",alias:"avgDowntime"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:4,width:4},configurable:!0,options:{trendConfig:{comparisonPeriod:"30d",showPercentage:!0,showArrow:!0}}},{id:"fault-breakdown",type:"overview-card",title:"Fault Types",description:"Breakdown of faults by severity",icon:"IconPieChart",dataSource:{apiEntity:"FaultDataEntity",aggregationParams:{groupBy:["severity"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:3,column:0,width:6},configurable:!0}],Te={id:De,name:Pe,description:Me,category:Re,icon:Le,estimatedUsers:Ie,tags:Ae,requiredPermissions:Be,defaultModules:Oe,availableModules:Fe},Ve="compliance-dashboard",$e="Compliance Dashboard",qe="Monitor HOS compliance, manage violations, and track driver availability",Ue="compliance",We="IconShieldCheck",He=133722,ze=["HOS","compliance","violations","drivers","IFTA","ELD"],Ge=["ViewHoSLogs","ViewDutyStatusViolations","ViewIftaMiles"],Je=[{id:"compliance-status",type:"overview-card",title:"Active Violations",description:"Drivers with current HOS violations",icon:"IconAlertTriangle",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["database"],aggregations:[{op:"count",field:"*",alias:"violationCount"}]},filters:[{field:"isActive",operator:"=",value:!0}],dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:0,width:4},configurable:!1,required:!0,options:{trendConfig:{comparisonPeriod:"7d",showPercentage:!0,showArrow:!0}}},{id:"driver-availability",type:"overview-card",title:"Available Drivers",description:"Drivers with sufficient hours remaining",icon:"IconUsers",dataSource:{apiEntity:"DutyStatusAvailability",aggregationParams:{groupBy:["database"],aggregations:[{op:"count",field:"*",alias:"availableCount"}]},filters:[{field:"drivingHoursRemaining",operator:">=",value:4}],dateRangeEnabled:!1,groupFilterEnabled:!0},defaultPosition:{row:0,column:4,width:4},configurable:!1,required:!0,options:{trendConfig:{comparisonPeriod:"7d",showPercentage:!0,showArrow:!0}}},{id:"ifta-summary",type:"overview-card",title:"IFTA Miles (Current Quarter)",description:"Total miles by jurisdiction",icon:"IconMap",dataSource:{apiEntity:"IftaDetail",aggregationParams:{groupBy:["database"],aggregations:[{op:"sum",field:"totalMiles",alias:"totalMiles"},{op:"sum",field:"fuelConsumed",alias:"totalFuel"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:8,width:4},configurable:!0,options:{trendConfig:{comparisonPeriod:"90d",showPercentage:!0,showArrow:!1}}},{id:"critical-violations",type:"immediate-actions",title:"Critical Violations",description:"HOS violations requiring immediate attention",icon:"IconAlert",dataSource:{apiEntity:"DutyStatusViolation",filters:[{field:"isActive",operator:"=",value:!0},{field:"severity",operator:"IN",value:["Critical","High"]}],dateRangeEnabled:!0,groupFilterEnabled:!0,resultsLimit:100},defaultPosition:{row:1,column:0,width:12},configurable:!1,required:!0,options:{navigationConfig:[{id:"active-violations",label:"Active Violations",pageName:"hosViolations",pageState:{isActive:!0,severity:["Critical","High"]}},{id:"approaching-limits",label:"Drivers Approaching Limits",pageName:"hosAvailability",pageState:{hoursRemaining:{max:2}}},{id:"missing-logs",label:"Missing Logs",pageName:"hosLogs",pageState:{hasCertified:!1,daysBack:7}}]}},{id:"violation-trend",type:"metric-chart",title:"Compliance Metrics",description:"Track compliance performance over time",icon:"IconChartLine",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*",alias:"violationCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"date",sortDirection:"asc"}},defaultPosition:{row:2,column:0,width:12},configurable:!0,options:{availableMetrics:[{id:"violation-count",label:"Violation Count",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"available-hours",label:"Average Available Hours",dataSource:{apiEntity:"DutyStatusAvailability",aggregationParams:{groupBy:["date"],aggregations:[{op:"avg",field:"drivingHoursRemaining"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"log-completeness",label:"Log Completeness %",dataSource:{apiEntity:"DutyStatusLog",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*",alias:"totalLogs"},{op:"count",field:"hasCertified",alias:"certifiedLogs",where:"hasCertified = true"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}}]}},{id:"top-violators",type:"performance-rankings",title:"Top Violators",description:"Drivers with most violations",icon:"IconUser",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"violationCount"},{op:"count",field:"severity",alias:"criticalCount",where:"severity = 'Critical'"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"violationCount",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:3,column:0,width:6},configurable:!0,options:{rankingLimit:10}}],Ye=[{id:"compliant-drivers",type:"performance-rankings",title:"Most Compliant Drivers",description:"Drivers with fewest violations",icon:"IconTrophy",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"violationCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"violationCount",sortDirection:"asc"},resultsLimit:10},defaultPosition:{row:3,column:6,width:6},configurable:!0,options:{rankingLimit:10}},{id:"violation-types",type:"overview-card",title:"Violation Types Breakdown",description:"Distribution of violations by type",icon:"IconPieChart",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["violationType"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:4,column:0,width:6},configurable:!0},{id:"jurisdiction-miles",type:"performance-rankings",title:"Miles by Jurisdiction",description:"IFTA miles breakdown by state/province",icon:"IconMap",dataSource:{apiEntity:"IftaDetail",aggregationParams:{groupBy:["jurisdiction"],aggregations:[{op:"sum",field:"totalMiles",alias:"miles"},{op:"sum",field:"fuelConsumed",alias:"fuel"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"miles",sortDirection:"desc"},resultsLimit:15},defaultPosition:{row:4,column:6,width:6},configurable:!0,options:{rankingLimit:15}}],Qe={id:Ve,name:$e,description:qe,category:Ue,icon:We,estimatedUsers:He,tags:ze,requiredPermissions:Ge,defaultModules:Je,availableModules:Ye};class Xe{constructor(){D(this,"recipes");this.recipes=[Ce,Te,Qe]}async loadRecipes(){return Promise.resolve(this.recipes)}getRecipeById(a){return this.recipes.find(i=>i.id===a)}filterByCategory(a){return this.recipes.filter(i=>i.category===a)}search(a){if(!a||a.trim()==="")return this.recipes;const i=a.toLowerCase();return this.recipes.filter(r=>{var s;return r.name.toLowerCase().includes(i)||r.description.toLowerCase().includes(i)||((s=r.tags)==null?void 0:s.some(n=>n.toLowerCase().includes(i)))})}getCategories(){const a=this.recipes.map(i=>i.category);return Array.from(new Set(a))}sortByPopularity(a){return[...a].sort((i,r)=>(r.estimatedUsers||0)-(i.estimatedUsers||0))}}const P=new Xe;function Ke(t,a){const[i,r]=u.useState([]),[s,n]=u.useState([]),[o,l]=u.useState(!0),[c,d]=u.useState(null),{hasPermissions:h}=_e();return u.useEffect(()=>{async function m(){try{l(!0);const _=(await P.loadRecipes()).filter(b=>h(b.requiredPermissions));r(_);let f=_;t&&(f=f.filter(b=>b.category===t)),a&&(f=P.search(a)),f=P.sortByPopularity(f),n(f)}catch(p){d(p)}finally{l(!1)}}m()},[t,a]),{recipes:i,filteredRecipes:s,loading:o,error:c}}const H=u.createContext(void 0);function Ze({children:t}){const{recipes:a,filteredRecipes:i,loading:r,error:s}=Ke();return e.jsx(H.Provider,{value:{recipes:a,filteredRecipes:i,loading:r,error:s},children:t})}function ea(){const t=u.useContext(H);if(!t)throw new Error("useRecipeContext must be used within RecipeProvider");return t}const z={step:"recipe-picker",selectedModules:[],selectedLayout:"grid",isSaved:!1};function aa(t,a){switch(a.type){case"SELECT_RECIPE":return{...t,selectedRecipe:a.payload,selectedModules:a.payload.defaultModules,step:"module-selector"};case"UPDATE_MODULES":return{...t,selectedModules:a.payload};case"SELECT_LAYOUT":return{...t,selectedLayout:a.payload};case"NEXT_STEP":const i=["recipe-picker","module-selector","layout-selector","preview","save"],r=i.indexOf(t.step),s=i[Math.min(r+1,i.length-1)];return{...t,step:s};case"PREV_STEP":const n=["recipe-picker","module-selector","layout-selector","preview","save"],o=n.indexOf(t.step),l=n[Math.max(o-1,0)];return{...t,step:l};case"GO_TO_STEP":return{...t,step:a.payload};case"SAVE_SUCCESS":return{...t,isSaved:!0,savedDashboardId:a.payload};case"RESET":return z;default:return t}}const G=u.createContext(void 0);function ta({children:t}){const[a,i]=u.useReducer(aa,z);return e.jsx(G.Provider,{value:{state:a,dispatch:i},children:t})}function y(){const t=u.useContext(G);if(!t)throw new Error("useDashboardContext must be used within DashboardProvider");return t}class ia extends u.Component{constructor(i){super(i);D(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,r){console.error("ErrorBoundary caught error:",i,r),this.setState({error:i,errorInfo:r})}render(){var i;return this.state.hasError?e.jsx("div",{className:"error-boundary",children:e.jsxs("div",{className:"error-boundary__content",children:[e.jsx("div",{className:"error-boundary__icon",children:"âš ï¸"}),e.jsx("h2",{className:"error-boundary__title",children:"Something went wrong"}),e.jsx("p",{className:"error-boundary__message",children:((i=this.state.error)==null?void 0:i.message)||"An unexpected error occurred"}),!1,e.jsx("button",{className:"error-boundary__button",onClick:this.handleReset,children:"Try Again"})]})}):this.props.children}}function ra({current:t,total:a,showLabels:i=!0}){const r=t/a*100;return e.jsxs("div",{className:"progress-bar",children:[e.jsx("div",{className:"progress-bar__track",children:e.jsx("div",{className:"progress-bar__fill",style:{width:`${r}%`}})}),i&&e.jsxs("div",{className:"progress-bar__label",children:["Step ",t," of ",a]})]})}function x({message:t="Loading...",size:a="medium"}){return e.jsxs("div",{className:`loading-state loading-state--${a}`,children:[e.jsx("div",{className:"loading-state__spinner",children:e.jsx("div",{className:"spinner"})}),t&&e.jsx("p",{className:"loading-state__message",children:t})]})}function sa(){const{dispatch:t}=y(),{recipes:a,loading:i,error:r}=ea(),[s,n]=u.useState(""),[o,l]=u.useState("all"),c=a.filter(m=>{const p=!s||m.name.toLowerCase().includes(s.toLowerCase())||m.description.toLowerCase().includes(s.toLowerCase()),_=o==="all"||m.category===o;return p&&_}),d=m=>{t({type:"SELECT_RECIPE",payload:m})},h=()=>{console.log("Create custom dashboard")};return i?e.jsx(x,{message:"Loading recipes..."}):r?e.jsx("div",{className:"recipe-picker__error",children:e.jsxs("p",{children:["Error loading recipes: ",r.message]})}):e.jsxs("div",{className:"recipe-picker",children:[e.jsxs("div",{className:"recipe-picker__header",children:[e.jsx("h2",{className:"recipe-picker__title",children:"What would you like to track?"}),e.jsx("p",{className:"recipe-picker__subtitle",children:"Choose a pre-built recipe or start from scratch"})]}),e.jsxs("div",{className:"recipe-picker__filters",children:[e.jsx("input",{type:"text",className:"recipe-picker__search",placeholder:"Search recipes...",value:s,onChange:m=>n(m.target.value)}),e.jsxs("select",{className:"recipe-picker__category",value:o,onChange:m=>l(m.target.value),children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"safety",children:"Safety"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"compliance",children:"Compliance"}),e.jsx("option",{value:"operations",children:"Operations"}),e.jsx("option",{value:"fuel",children:"Fuel"})]})]}),e.jsxs("div",{className:"recipe-picker__grid",children:[c.map(m=>{var p;return e.jsxs("div",{className:"recipe-card",onClick:()=>d(m),children:[e.jsx("div",{className:"recipe-card__icon",children:m.icon}),e.jsx("h3",{className:"recipe-card__name",children:m.name}),e.jsx("p",{className:"recipe-card__description",children:m.description}),m.estimatedUsers&&e.jsxs("div",{className:"recipe-card__users",children:[m.estimatedUsers.toLocaleString(),"+ users"]}),e.jsx("div",{className:"recipe-card__tags",children:(p=m.tags)==null?void 0:p.slice(0,3).map(_=>e.jsx("span",{className:"recipe-card__tag",children:_},_))}),e.jsx("button",{className:"recipe-card__button",children:"Select"})]},m.id)}),e.jsxs("div",{className:"recipe-card recipe-card--custom",onClick:h,children:[e.jsx("div",{className:"recipe-card__icon",children:"+"}),e.jsx("h3",{className:"recipe-card__name",children:"Start from Scratch"}),e.jsx("p",{className:"recipe-card__description",children:"Build a custom dashboard with your own modules"}),e.jsx("button",{className:"recipe-card__button",children:"Create Custom"})]})]}),e.jsx("div",{className:"recipe-picker__tip",children:"ðŸ’¡ Tip: Recipes come pre-configured with proven insights. You can customize them in the next step."})]})}function R({onBack:t,onNext:a,canGoBack:i=!0,canGoNext:r=!0,nextLabel:s="Continue",backLabel:n="Back"}){return e.jsxs("div",{className:"step-navigation",children:[e.jsx("div",{className:"step-navigation__left",children:t&&e.jsxs("button",{className:"step-navigation__button step-navigation__button--back",onClick:t,disabled:!i,children:["â† ",n]})}),e.jsx("div",{className:"step-navigation__right",children:a&&e.jsxs("button",{className:"step-navigation__button step-navigation__button--next",onClick:a,disabled:!r,children:[s," â†’"]})})]})}function na(){const{state:t,dispatch:a}=y(),{selectedRecipe:i,selectedModules:r}=t;if(!i)return e.jsx("div",{children:"No recipe selected"});const s=c=>r.some(d=>d.id===c),n=c=>{if(c.required&&s(c.id))return;const d=s(c.id)?r.filter(h=>h.id!==c.id):[...r,c];a({type:"UPDATE_MODULES",payload:d})},o=()=>{a({type:"PREV_STEP"})},l=()=>{a({type:"NEXT_STEP"})};return e.jsxs("div",{className:"module-selector",children:[e.jsxs("div",{className:"module-selector__header",children:[e.jsx("h2",{className:"module-selector__title",children:i.name}),e.jsx("p",{className:"module-selector__subtitle",children:"Which insights do you want to include?"})]}),e.jsxs("div",{className:"module-selector__section",children:[e.jsxs("h3",{className:"module-selector__section-title",children:["Included Modules (",r.length,")"]}),e.jsx("div",{className:"module-list",children:i.defaultModules.map(c=>e.jsxs("div",{className:`module-item ${s(c.id)?"module-item--selected":""}`,children:[e.jsx("input",{type:"checkbox",id:c.id,checked:s(c.id),onChange:()=>n(c),disabled:c.required}),e.jsxs("label",{htmlFor:c.id,className:"module-item__content",children:[e.jsxs("div",{className:"module-item__header",children:[e.jsx("span",{className:"module-item__name",children:c.title}),c.required&&e.jsx("span",{className:"module-item__badge",children:"Required"})]}),e.jsx("p",{className:"module-item__description",children:c.description})]})]},c.id))})]}),i.availableModules.length>0&&e.jsxs("div",{className:"module-selector__section",children:[e.jsxs("h3",{className:"module-selector__section-title",children:["Available Modules (",i.availableModules.length,")"]}),e.jsx("div",{className:"module-list",children:i.availableModules.map(c=>e.jsxs("div",{className:`module-item ${s(c.id)?"module-item--selected":""}`,children:[e.jsx("input",{type:"checkbox",id:c.id,checked:s(c.id),onChange:()=>n(c)}),e.jsxs("label",{htmlFor:c.id,className:"module-item__content",children:[e.jsx("div",{className:"module-item__header",children:e.jsx("span",{className:"module-item__name",children:c.title})}),e.jsx("p",{className:"module-item__description",children:c.description})]})]},c.id))})]}),e.jsx("div",{className:"module-selector__tip",children:"ðŸ’¡ Tip: You can drag to reorder modules in the next step"}),e.jsx(R,{onBack:o,onNext:l,canGoNext:r.length>0})]})}function L(t,a){switch(a){case"single-column":return oa(t);case"two-column":return ca(t);case"grid":return la(t);default:return t}}function oa(t){return t.map((a,i)=>({...a,defaultPosition:{row:i,column:0,width:12}}))}function ca(t){return t.map((a,i)=>{const r=i%2===0,s=Math.floor(i/2);return{...a,defaultPosition:{row:s,column:r?0:6,width:6}}})}function la(t){let a=0,i=0;return t.map((r,s)=>{const n=s<3?4:6,o={row:a,column:i,width:n};return i+=n,i>=12&&(i=0,a++),{...r,defaultPosition:o}})}function da(t){return t<=3?"single-column":t<=6?"two-column":"grid"}function ua(t){return{"single-column":"Single Column","two-column":"Two Column",grid:"Grid"}[t]}function ma(t){return{"single-column":"Best for mobile or narrow screens","two-column":"Best for desktop screens",grid:"Best for wide desktop screens"}[t]}function ha(){const{state:t,dispatch:a}=y(),{selectedModules:i,selectedLayout:r}=t,s=da(i.length),n=["single-column","two-column","grid"],o=d=>{a({type:"SELECT_LAYOUT",payload:d})},l=()=>{a({type:"PREV_STEP"})},c=()=>{a({type:"NEXT_STEP"})};return e.jsxs("div",{className:"layout-selector",children:[e.jsx("div",{className:"layout-selector__header",children:e.jsx("h2",{className:"layout-selector__title",children:"How would you like to arrange your dashboard?"})}),e.jsx("div",{className:"layout-selector__grid",children:n.map(d=>e.jsxs("div",{className:`layout-card ${r===d?"layout-card--selected":""}`,onClick:()=>o(d),children:[e.jsxs("div",{className:"layout-card__preview",children:[d==="single-column"&&e.jsxs("div",{className:"layout-preview layout-preview--single",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),d==="two-column"&&e.jsxs("div",{className:"layout-preview layout-preview--two",children:[e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsx("div",{className:"layout-preview__item layout-preview__item--full"})]}),d==="grid"&&e.jsxs("div",{className:"layout-preview layout-preview--grid",children:[e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsx("div",{className:"layout-preview__item layout-preview__item--full"})]})]}),e.jsxs("h3",{className:"layout-card__name",children:[ua(d),d===s&&e.jsx("span",{className:"layout-card__badge",children:"Recommended"})]}),e.jsx("p",{className:"layout-card__description",children:ma(d)}),e.jsx("button",{className:`layout-card__button ${r===d?"layout-card__button--selected":""}`,children:r===d?"âœ“ Selected":"Select"})]},d))}),e.jsx(R,{onBack:l,onNext:c,nextLabel:"Preview"})]})}function J(t="score"){switch(t){case"score":return Math.floor(Math.random()*100);case"count":return Math.floor(Math.random()*50);case"percentage":return Math.floor(Math.random()*100);default:return 0}}function ga(){const t=Math.floor(Math.random()*20)-10;return{value:J("score"),change:Math.abs(t),direction:t>=0?"up":"down"}}function pa(t=30){const a=[],i=new Date;for(let r=t-1;r>=0;r--){const s=new Date(i);s.setDate(s.getDate()-r),a.push({date:s.toISOString().split("T")[0],value:Math.floor(Math.random()*100)+20})}return a}function va(t=10){return["John Smith","Jane Doe","Bob Johnson","Alice Williams","Charlie Brown","Diana Prince","Eve Anderson","Frank Miller","Grace Lee","Henry Davis","Ivy Chen","Jack Wilson"].slice(0,t).map((i,r)=>({id:`driver-${r+1}`,name:i,value:Math.floor(Math.random()*30)+5,score:100-r*5-Math.floor(Math.random()*5)}))}function _a(t=3){return[{title:"Critical Exceptions",severity:"critical"},{title:"High-Risk Drivers",severity:"high"},{title:"Vehicles Needing Attention",severity:"medium"},{title:"Severe Work Requests",severity:"critical"},{title:"Active Violations",severity:"high"},{title:"Missing Logs",severity:"medium"}].slice(0,t).map((i,r)=>({id:`alert-${r+1}`,title:i.title,count:Math.floor(Math.random()*15)+1,severity:i.severity}))}function fa(){const t=Math.floor(Math.random()*40)+40;return{fleetScore:t,industryAverage:65,percentile:Math.floor(t/100*100)}}function Y(){return localStorage.getItem("overviewBuilder.useMockData")!=="false"}function ba(t){localStorage.setItem("overviewBuilder.useMockData",String(t))}class xa{async fetchModuleData(a,i,r,s,n){return Y()?this.fetchMockData(r):this.fetchRealData(a,i,r,s,n)}async fetchMockData(a){switch(await new Promise(i=>setTimeout(i,500)),a.type){case"overview-card":return{metric:J("score"),...ga()};case"immediate-actions":return{alerts:_a(3)};case"metric-chart":return{series:pa(30)};case"performance-rankings":return{rankings:va(10)};case"benchmark-bar":return fa();default:return{}}}async fetchRealData(a,i,r,s,n){const{dataSource:o}=r;try{const l={};return o.dateRangeEnabled&&s&&(l.fromDate=s.start,l.toDate=s.end),o.groupFilterEnabled&&n&&(l.groupFilterCondition=n),o.filters&&o.filters.forEach(c=>{l[c.field]=c.value}),o.aggregationParams?await this.callAggregationAPI(a,i,o.apiEntity,o.aggregationParams,l,o.sort,o.resultsLimit):await this.callGetAPI(a,i,o.apiEntity,l,o.sort,o.resultsLimit)}catch(l){throw console.error("Error fetching module data:",l),l}}async callAggregationAPI(a,i,r,s,n,o,l){return console.log("Calling aggregation API:",{entityType:r,aggregationParams:s,search:n,sort:o,limit:l}),this.fetchMockData({type:"metric-chart"})}async callGetAPI(a,i,r,s,n,o){return console.log("Calling Get API:",{entityType:r,search:s,sort:n,limit:o}),this.fetchMockData({type:"immediate-actions"})}}const ya=new xa;function w(t,a,i,r=!0){const{api:s,credentials:n}=M();return ne({queryKey:["module-data",t.id,a,i],queryFn:()=>ya.fetchModuleData(s,n,t,a,i),enabled:r&&!!s&&!!t,staleTime:5*60*1e3,retry:1})}function wa({module:t,useLiveData:a=!1}){const{data:i,isLoading:r,error:s}=w(t,void 0,void 0,a);if(r)return e.jsx("div",{className:"overview-card",children:e.jsx(x,{size:"small",message:""})});if(s)return e.jsx("div",{className:"overview-card overview-card--error",children:e.jsx("div",{className:"overview-card__error",children:"Error loading data"})});const n=(i==null?void 0:i.metric)||0,o=(i==null?void 0:i.change)||0,l=(i==null?void 0:i.direction)||"up";return e.jsxs("div",{className:"overview-card",children:[t.icon&&e.jsx("div",{className:"overview-card__icon",children:t.icon}),e.jsxs("div",{className:"overview-card__content",children:[e.jsx("div",{className:"overview-card__header",children:e.jsx("h3",{className:"overview-card__title",children:t.title})}),t.description&&e.jsx("p",{className:"overview-card__description",children:t.description}),e.jsx("div",{className:"overview-card__metric",children:e.jsx("span",{className:"overview-card__value",children:n})}),o!==0&&e.jsxs("div",{className:`overview-card__trend overview-card__trend--${l}`,children:[e.jsx("span",{className:"overview-card__trend-icon",children:l==="up"?"â†‘":"â†“"}),e.jsxs("span",{className:"overview-card__trend-value",children:[Math.abs(o),"%"]})]})]})]})}function ja({module:t,useLiveData:a=!1}){var l;const{data:i,isLoading:r,error:s}=w(t,void 0,void 0,a);if(r)return e.jsx("div",{className:"immediate-actions",children:e.jsx(x,{size:"small",message:"Loading actions..."})});if(s)return e.jsx("div",{className:"immediate-actions immediate-actions--error",children:e.jsx("div",{className:"immediate-actions__error",children:"Error loading actions"})});const n=(i==null?void 0:i.alerts)||[],o=((l=t.options)==null?void 0:l.navigationConfig)||[];return e.jsxs("div",{className:"immediate-actions",children:[e.jsxs("div",{className:"immediate-actions__header",children:[e.jsx("h3",{className:"immediate-actions__title",children:t.title}),t.description&&e.jsx("p",{className:"immediate-actions__description",children:t.description})]}),e.jsx("div",{className:"immediate-actions__list",children:n.length===0?e.jsx("div",{className:"immediate-actions__empty",children:"âœ“ No items requiring immediate attention"}):n.map((c,d)=>e.jsxs("div",{className:`immediate-actions__item immediate-actions__item--${c.severity}`,children:[e.jsxs("div",{className:"immediate-actions__item-header",children:[e.jsx("span",{className:"immediate-actions__item-title",children:c.title}),e.jsx("span",{className:"immediate-actions__item-count",children:c.count})]}),o[d]&&e.jsx("button",{className:"immediate-actions__item-link",children:"View Details â†’"})]},d))}),o.length>0&&e.jsx("div",{className:"immediate-actions__footer",children:o.map(c=>e.jsx("button",{className:"immediate-actions__quick-link",children:c.label},c.id))})]})}function Na({module:t,useLiveData:a=!1}){var d;const i=((d=t.options)==null?void 0:d.availableMetrics)||[],[r,s]=u.useState(0),{data:n,isLoading:o,error:l}=w(t,void 0,void 0,a);if(o)return e.jsx("div",{className:"metric-chart",children:e.jsx(x,{size:"small",message:"Loading chart..."})});if(l)return e.jsx("div",{className:"metric-chart metric-chart--error",children:e.jsx("div",{className:"metric-chart__error",children:"Error loading chart"})});const c=(n==null?void 0:n.series)||[];return e.jsxs("div",{className:"metric-chart",children:[e.jsxs("div",{className:"metric-chart__header",children:[e.jsx("h3",{className:"metric-chart__title",children:t.title}),i.length>0&&e.jsx("select",{className:"metric-chart__selector",value:r,onChange:h=>s(Number(h.target.value)),children:i.map((h,m)=>e.jsx("option",{value:m,children:h.label},h.id))})]}),e.jsx("div",{className:"metric-chart__chart",children:c.length===0?e.jsx("div",{className:"metric-chart__empty",children:"No data available"}):e.jsx("div",{className:"metric-chart__visualization",children:e.jsx("div",{className:"metric-chart__bars",children:c.slice(-10).map((h,m)=>{const p=Math.max(...c.map(f=>f.value)),_=h.value/p*100;return e.jsxs("div",{className:"metric-chart__bar-wrapper",children:[e.jsx("div",{className:"metric-chart__bar",style:{height:`${_}%`},title:`${h.date}: ${h.value}`}),e.jsx("div",{className:"metric-chart__bar-label",children:new Date(h.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]},m)})})})})]})}function ka({module:t,useLiveData:a=!1}){var l;const{data:i,isLoading:r,error:s}=w(t,void 0,void 0,a);if(r)return e.jsx("div",{className:"performance-rankings",children:e.jsx(x,{size:"small",message:"Loading rankings..."})});if(s)return e.jsx("div",{className:"performance-rankings performance-rankings--error",children:e.jsx("div",{className:"performance-rankings__error",children:"Error loading rankings"})});const n=(i==null?void 0:i.rankings)||[],o=((l=t.options)==null?void 0:l.rankingLimit)||10;return e.jsxs("div",{className:"performance-rankings",children:[e.jsxs("div",{className:"performance-rankings__header",children:[e.jsx("h3",{className:"performance-rankings__title",children:t.title}),t.description&&e.jsx("p",{className:"performance-rankings__description",children:t.description})]}),e.jsx("div",{className:"performance-rankings__list",children:n.length===0?e.jsx("div",{className:"performance-rankings__empty",children:"No data available"}):n.slice(0,o).map((c,d)=>e.jsxs("div",{className:"performance-rankings__item",children:[e.jsxs("div",{className:"performance-rankings__rank",children:["#",d+1]}),e.jsxs("div",{className:"performance-rankings__content",children:[e.jsx("div",{className:"performance-rankings__name",children:c.name}),e.jsxs("div",{className:"performance-rankings__details",children:[e.jsx("span",{className:"performance-rankings__value",children:c.value}),c.score&&e.jsxs("span",{className:"performance-rankings__score",children:["Score: ",c.score]})]})]}),e.jsx("button",{className:"performance-rankings__link",children:"â†’"})]},c.id))}),n.length>o&&e.jsx("div",{className:"performance-rankings__footer",children:e.jsxs("button",{className:"performance-rankings__view-all",children:["View All (",n.length,")"]})})]})}function Sa({module:t,useLiveData:a=!1}){var h;const{data:i,isLoading:r,error:s}=w(t,void 0,void 0,a);if(r)return e.jsx("div",{className:"benchmark-bar",children:e.jsx(x,{size:"small",message:"Loading benchmark..."})});if(s)return e.jsx("div",{className:"benchmark-bar benchmark-bar--error",children:e.jsx("div",{className:"benchmark-bar__error",children:"Error loading benchmark"})});const n=(i==null?void 0:i.fleetScore)||0,o=(i==null?void 0:i.industryAverage)||((h=t.options)==null?void 0:h.benchmarkValue)||65,l=(i==null?void 0:i.percentile)||50,d=(()=>n>=o+10?"good":n>=o-10?"average":"below")();return e.jsxs("div",{className:"benchmark-bar",children:[e.jsxs("div",{className:"benchmark-bar__header",children:[e.jsx("h3",{className:"benchmark-bar__title",children:t.title}),t.description&&e.jsx("p",{className:"benchmark-bar__description",children:t.description})]}),e.jsxs("div",{className:"benchmark-bar__content",children:[e.jsxs("div",{className:"benchmark-bar__scores",children:[e.jsxs("div",{className:"benchmark-bar__score",children:[e.jsx("div",{className:"benchmark-bar__score-label",children:"Your Fleet"}),e.jsx("div",{className:"benchmark-bar__score-value benchmark-bar__score-value--fleet",children:n})]}),e.jsxs("div",{className:"benchmark-bar__score",children:[e.jsx("div",{className:"benchmark-bar__score-label",children:"Industry Average"}),e.jsx("div",{className:"benchmark-bar__score-value benchmark-bar__score-value--industry",children:o})]})]}),e.jsxs("div",{className:"benchmark-bar__visualization",children:[e.jsxs("div",{className:"benchmark-bar__track",children:[e.jsx("div",{className:`benchmark-bar__fill benchmark-bar__fill--${d}`,style:{width:`${n}%`}}),e.jsx("div",{className:"benchmark-bar__marker",style:{left:`${o}%`},title:`Industry Average: ${o}`})]}),e.jsxs("div",{className:"benchmark-bar__labels",children:[e.jsx("span",{children:"0"}),e.jsx("span",{children:"50"}),e.jsx("span",{children:"100"})]})]}),e.jsxs("div",{className:"benchmark-bar__status",children:[d==="good"&&e.jsxs("div",{className:"benchmark-bar__message benchmark-bar__message--good",children:["âœ“ Above industry average (",l,"th percentile)"]}),d==="average"&&e.jsxs("div",{className:"benchmark-bar__message benchmark-bar__message--average",children:["â‰ˆ Near industry average (",l,"th percentile)"]}),d==="below"&&e.jsxs("div",{className:"benchmark-bar__message benchmark-bar__message--below",children:["âš  Below industry average (",l,"th percentile)"]})]})]})]})}function I({module:t,useLiveData:a=!1}){switch(t.type){case"overview-card":return e.jsx(wa,{module:t,useLiveData:a});case"immediate-actions":return e.jsx(ja,{module:t,useLiveData:a});case"metric-chart":return e.jsx(Na,{module:t,useLiveData:a});case"performance-rankings":return e.jsx(ka,{module:t,useLiveData:a});case"benchmark-bar":return e.jsx(Sa,{module:t,useLiveData:a});default:return e.jsxs("div",{className:"module-renderer__unknown",children:["Unknown module type: ",t.type]})}}function O({modules:t,useLiveData:a=!1}){const i=L(t,"grid");return e.jsx("div",{className:"grid-layout",children:i.map(r=>e.jsx("div",{className:"grid-layout__item",style:{gridRow:r.defaultPosition.row+1,gridColumn:`span ${r.defaultPosition.width}`},children:e.jsx(I,{module:r,useLiveData:a})},r.id))})}function Ea({modules:t,useLiveData:a=!1}){const i=L(t,"two-column");return e.jsx("div",{className:"two-column-layout",children:i.map(r=>e.jsx("div",{className:"two-column-layout__item",style:{gridRow:r.defaultPosition.row+1,gridColumn:`span ${r.defaultPosition.width}`},children:e.jsx(I,{module:r,useLiveData:a})},r.id))})}function Ca({modules:t,useLiveData:a=!1}){const i=L(t,"single-column");return e.jsx("div",{className:"single-column-layout",children:i.map(r=>e.jsx("div",{className:"single-column-layout__item",children:e.jsx(I,{module:r,useLiveData:a})},r.id))})}function Da(){const{state:t,dispatch:a}=y(),{selectedModules:i,selectedLayout:r,selectedRecipe:s}=t,[n,o]=u.useState(!Y()),[l,c]=u.useState("30d"),[d,h]=u.useState("all"),[m,p]=u.useState("5m"),_=g=>{o(g),ba(!g)},f=()=>{a({type:"PREV_STEP"})},b=()=>{a({type:"NEXT_STEP"})},S=()=>{const g={modules:i,useLiveData:n};switch(r){case"grid":return e.jsx(O,{...g});case"two-column":return e.jsx(Ea,{...g});case"single-column":return e.jsx(Ca,{...g});default:return e.jsx(O,{...g})}};return e.jsxs("div",{className:"dashboard-preview",children:[e.jsxs("div",{className:"dashboard-preview__header",children:[e.jsx("h2",{className:"dashboard-preview__title",children:"Preview your dashboard"}),e.jsx("p",{className:"dashboard-preview__subtitle",children:(s==null?void 0:s.name)||"Custom Dashboard"})]}),e.jsxs("div",{className:"dashboard-preview__preview",children:[e.jsx("div",{className:"dashboard-preview__toolbar",children:e.jsxs("div",{className:"dashboard-preview__filters",children:[e.jsxs("select",{value:l,onChange:g=>c(g.target.value),className:"dashboard-preview__filter",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"custom",children:"Custom"})]}),e.jsxs("select",{value:d,onChange:g=>h(g.target.value),className:"dashboard-preview__filter",children:[e.jsx("option",{value:"all",children:"All groups"}),e.jsx("option",{value:"fleet1",children:"Fleet 1"}),e.jsx("option",{value:"fleet2",children:"Fleet 2"})]})]})}),e.jsx("div",{className:"dashboard-preview__content",children:S()}),e.jsxs("div",{className:"dashboard-preview__notice",children:[n?e.jsx("div",{className:"dashboard-preview__info",children:"âœ“ Showing live data"}):e.jsx("div",{className:"dashboard-preview__warning",children:"âš  Showing placeholder data for preview"}),e.jsxs("label",{className:"dashboard-preview__checkbox",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:g=>_(g.target.checked)}),e.jsx("span",{children:"Show live data (this may take a moment)"})]})]})]}),e.jsxs("div",{className:"dashboard-preview__settings",children:[e.jsx("h3",{className:"dashboard-preview__settings-title",children:"Global Settings (Optional)"}),e.jsxs("div",{className:"dashboard-preview__settings-grid",children:[e.jsxs("div",{className:"dashboard-preview__setting",children:[e.jsx("label",{children:"Default Date Range:"}),e.jsxs("select",{value:l,onChange:g=>c(g.target.value),children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"})]})]}),e.jsxs("div",{className:"dashboard-preview__setting",children:[e.jsx("label",{children:"Default Groups:"}),e.jsx("select",{value:d,onChange:g=>h(g.target.value),children:e.jsx("option",{value:"all",children:"All groups"})})]}),e.jsxs("div",{className:"dashboard-preview__setting",children:[e.jsx("label",{children:"Auto-Refresh:"}),e.jsxs("select",{value:m,onChange:g=>p(g.target.value),children:[e.jsx("option",{value:"0",children:"Manual only"}),e.jsx("option",{value:"5m",children:"Every 5 minutes"}),e.jsx("option",{value:"15m",children:"Every 15 minutes"}),e.jsx("option",{value:"30m",children:"Every 30 minutes"})]})]}),e.jsx("div",{className:"dashboard-preview__setting",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{children:"Allow users to change date range"})]})})]})]}),e.jsx(R,{onBack:f,onNext:b,nextLabel:"Save",backLabel:"Edit"})]})}function Pa(t){const a=[];return(!t||t.trim()==="")&&a.push("Dashboard name is required"),t.length>50&&a.push("Dashboard name must be 50 characters or less"),t.length<3&&a.push("Dashboard name must be at least 3 characters"),/[<>:"/\\|?*]/.test(t)&&a.push("Dashboard name contains invalid characters"),{isValid:a.length===0,errors:a}}class Ma{createFromRecipe(a,i,r,s){return{id:this.generateId(),name:a.name,description:a.description,recipeId:a.id,layout:r,modules:i,dateRange:{defaultPeriod:"30d",allowCustom:!0},groupsFilter:{enabled:!0},refreshInterval:300,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:s,isShared:!1}}createBlank(a,i,r,s){return{id:this.generateId(),name:a,layout:r,modules:i,dateRange:{defaultPeriod:"30d",allowCustom:!0},groupsFilter:{enabled:!0},refreshInterval:300,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:s,isShared:!1}}async saveDashboard(a,i){try{const r=this.getAllDashboards(),s=r.findIndex(n=>n.id===i.id);return s>=0?r[s]={...i,updatedAt:new Date().toISOString()}:r.push(i),localStorage.setItem("overviewBuilder.dashboards",JSON.stringify(r)),i.id}catch(r){throw console.error("Error saving dashboard:",r),new Error("Failed to save dashboard")}}getDashboardById(a){return this.getAllDashboards().find(r=>r.id===a)}getAllDashboards(){try{const a=localStorage.getItem("overviewBuilder.dashboards");return a?JSON.parse(a):[]}catch(a){return console.error("Error loading dashboards:",a),[]}}async deleteDashboard(a){const r=this.getAllDashboards().filter(s=>s.id!==a);localStorage.setItem("overviewBuilder.dashboards",JSON.stringify(r))}async updateDashboard(a){const i=this.getAllDashboards(),r=i.findIndex(s=>s.id===a.id);if(r>=0)i[r]={...a,updatedAt:new Date().toISOString()},localStorage.setItem("overviewBuilder.dashboards",JSON.stringify(i));else throw new Error("Dashboard not found")}generateId(){return`dashboard-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}const F=new Ma;function Ra(){const{state:t}=y(),{credentials:a}=M(),{selectedRecipe:i,selectedModules:r,selectedLayout:s}=t,[n,o]=u.useState((i==null?void 0:i.name)||""),[l,c]=u.useState((i==null?void 0:i.description)||""),[d,h]=u.useState(!1),[m,p]=u.useState("private"),[_,f]=u.useState(!0),[b,S]=u.useState(!1),[g,A]=u.useState(!1),[E,j]=u.useState(null),[K,Z]=u.useState(!1),C=Pa(n),ee=async()=>{if(!C.isValid){j(C.errors[0]);return}A(!0),j(null);try{const v=F.createFromRecipe(i,r,s,a.userName);v.name=n,v.description=l,v.isShared=d;const te=await F.saveDashboard(null,v);Z(!0),setTimeout(()=>{console.log("Navigate to dashboard:",te)},2e3)}catch(v){j(v instanceof Error?v.message:"Failed to save dashboard")}finally{A(!1)}},ae=()=>{confirm("Are you sure? Your changes will be lost.")&&console.log("Cancelled")};return g?e.jsx(x,{message:"Saving your dashboard..."}):K?e.jsxs("div",{className:"save-dialog__success",children:[e.jsx("div",{className:"save-dialog__success-icon",children:"âœ“"}),e.jsx("h2",{className:"save-dialog__success-title",children:"Dashboard created successfully!"}),e.jsxs("p",{className:"save-dialog__success-message",children:["Your ",n," is ready to use"]}),e.jsxs("div",{className:"save-dialog__success-actions",children:[e.jsx("button",{className:"save-dialog__button save-dialog__button--primary",children:"View Dashboard"}),e.jsx("button",{className:"save-dialog__button",children:"Create Another"})]})]}):e.jsxs("div",{className:"save-dialog",children:[e.jsxs("div",{className:"save-dialog__header",children:[e.jsx("h2",{className:"save-dialog__title",children:"Save Dashboard"}),e.jsx("p",{className:"save-dialog__subtitle",children:"Give your dashboard a name"})]}),e.jsxs("div",{className:"save-dialog__form",children:[e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{htmlFor:"name",className:"save-dialog__label",children:"Dashboard Name *"}),e.jsx("input",{id:"name",type:"text",className:`save-dialog__input ${E?"save-dialog__input--error":""}`,value:n,onChange:v=>{o(v.target.value),j(null)},placeholder:"e.g., Safety Scorecard - Fleet Operations",maxLength:50}),E&&e.jsx("div",{className:"save-dialog__error",children:E}),e.jsxs("div",{className:"save-dialog__hint",children:[n.length,"/50 characters"]})]}),e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{htmlFor:"description",className:"save-dialog__label",children:"Description (optional)"}),e.jsx("textarea",{id:"description",className:"save-dialog__textarea",value:l,onChange:v=>c(v.target.value),placeholder:"Describe what this dashboard tracks...",rows:3,maxLength:200}),e.jsxs("div",{className:"save-dialog__hint",children:[l.length,"/200 characters"]})]}),e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{className:"save-dialog__label",children:"Sharing & Visibility"}),e.jsxs("div",{className:"save-dialog__options",children:[e.jsxs("label",{className:"save-dialog__radio",children:[e.jsx("input",{type:"radio",name:"sharing",value:"private",checked:m==="private",onChange:()=>{p("private"),h(!1)}}),e.jsx("span",{children:"Private (only me)"})]}),e.jsxs("label",{className:"save-dialog__radio",children:[e.jsx("input",{type:"radio",name:"sharing",value:"team",checked:m==="team",onChange:()=>{p("team"),h(!0)}}),e.jsx("span",{children:"Shared with my team"})]}),e.jsxs("label",{className:"save-dialog__radio",children:[e.jsx("input",{type:"radio",name:"sharing",value:"custom",checked:m==="custom",onChange:()=>{p("custom"),h(!0)}}),e.jsx("span",{children:"Shared with specific users/groups"})]})]})]}),e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{className:"save-dialog__label",children:"Menu Settings"}),e.jsxs("div",{className:"save-dialog__checkboxes",children:[e.jsxs("label",{className:"save-dialog__checkbox",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:v=>f(v.target.checked)}),e.jsx("span",{children:"Add to MyGeotab navigation menu"})]}),_&&e.jsxs("div",{className:"save-dialog__indent",children:[e.jsx("label",{htmlFor:"menu-location",children:"Location:"}),e.jsxs("select",{id:"menu-location",className:"save-dialog__select",children:[e.jsx("option",{value:"dashboards",children:"Dashboards"}),e.jsx("option",{value:"reports",children:"Reports"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("label",{className:"save-dialog__checkbox",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:v=>S(v.target.checked)}),e.jsx("span",{children:"Set as my default dashboard"})]}),b&&e.jsx("div",{className:"save-dialog__hint",children:"Opens automatically when you launch MyGeotab"})]})]})]}),e.jsxs("div",{className:"save-dialog__actions",children:[e.jsx("button",{className:"save-dialog__button",onClick:ae,children:"Cancel"}),e.jsx("button",{className:"save-dialog__button save-dialog__button--primary",onClick:ee,disabled:!C.isValid,children:"Save & Open"})]})]})}function La(){const{state:t}=y(),a={"recipe-picker":e.jsx(sa,{}),"module-selector":e.jsx(na,{}),"layout-selector":e.jsx(ha,{}),preview:e.jsx(Da,{}),save:e.jsx(Ra,{})},r=["recipe-picker","module-selector","layout-selector","preview","save"].indexOf(t.step);return e.jsxs("div",{className:"dashboard-wizard",children:[e.jsxs("div",{className:"dashboard-wizard__header",children:[e.jsx("h1",{className:"dashboard-wizard__title",children:"Create Dashboard"}),e.jsx(ra,{current:r+1,total:5})]}),e.jsx("div",{className:"dashboard-wizard__content",children:a[t.step]})]})}function Q({api:t,state:a}){return e.jsx(ia,{children:e.jsx(ge,{api:t,state:a,children:e.jsx(Ze,{children:e.jsx(ta,{children:e.jsx(La,{})})})})})}const X=new oe({defaultOptions:{queries:{staleTime:5*60*1e3,cacheTime:10*60*1e3,refetchOnWindowFocus:!1,retry:1}}});window.OverviewBuilder={initialize:(t,a,i)=>{console.log("Initializing Overview-Builder Add-In");const r=document.getElementById("overview-builder-root");if(!r){console.error("Container element not found");return}N.createRoot(r).render(e.jsx(V.StrictMode,{children:e.jsx($,{client:X,children:e.jsx(Q,{api:t,state:a})})})),i()},focus:(t,a)=>{console.log("Overview-Builder focused")},blur:(t,a)=>{console.log("Overview-Builder blurred")}};const T=()=>{const t=document.getElementById("overview-builder-root");t&&!t.hasChildNodes()&&(console.log("Initializing in standalone mode"),N.createRoot(t).render(e.jsx(V.StrictMode,{children:e.jsx($,{client:X,children:e.jsx(Q,{api:{},state:{database:"demo",userName:"developer"}})})})))};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",T):T();
//# sourceMappingURL=index-2eb8f992.js.map
