var K=Object.defineProperty;var Z=(t,a,r)=>a in t?K(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;var C=(t,a,r)=>(Z(t,typeof a!="symbol"?a+"":a,r),r);import{r as u,a as ee,R as ae}from"./vendor-b1791c80.js";import{u as te,Q as re,a as ie}from"./query-0b6e7572.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();var T={exports:{}},N={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var se=u,ne=Symbol.for("react.element"),oe=Symbol.for("react.fragment"),ce=Object.prototype.hasOwnProperty,le=se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,de={key:!0,ref:!0,__self:!0,__source:!0};function V(t,a,r){var i,s={},n=null,o=null;r!==void 0&&(n=""+r),a.key!==void 0&&(n=""+a.key),a.ref!==void 0&&(o=a.ref);for(i in a)ce.call(a,i)&&!de.hasOwnProperty(i)&&(s[i]=a[i]);if(t&&t.defaultProps)for(i in a=t.defaultProps,a)s[i]===void 0&&(s[i]=a[i]);return{$$typeof:ne,type:t,key:n,ref:o,props:s,_owner:le.current}}N.Fragment=oe;N.jsx=V;N.jsxs=V;T.exports=N;var e=T.exports,P={},B=ee;P.createRoot=B.createRoot,P.hydrateRoot=B.hydrateRoot;const $=u.createContext(void 0);function ue({api:t,state:a,children:r}){const i={api:t,state:a,credentials:{database:(a==null?void 0:a.database)||"demo",userName:(a==null?void 0:a.userName)||"user@example.com",sessionId:(a==null?void 0:a.sessionId)||"mock-session"}};return e.jsx($.Provider,{value:i,children:r})}function M(){const t=u.useContext($);if(!t)throw new Error("useAddInContext must be used within AddInProvider");return t}function me(t,a){return a.every(r=>t.includes(r))}function he(t,a){return a.filter(r=>!t.includes(r))}function ge(){const{api:t,state:a}=M(),r=u.useMemo(()=>["ViewCollisionRisk","ViewExceptions","ViewDrivers","ViewMaintenanceWorkOrders","ViewMaintenanceWorkRequests","ViewFaults","ViewMaintenanceOverview","ViewHoSLogs","ViewDutyStatusViolations","ViewIftaMiles"],[t,a]);return{userPermissions:r,hasPermissions:n=>me(r,n),missingPermissions:n=>he(r,n)}}const pe="safety-scorecard",ve="Safety Scorecard",_e="Monitor fleet safety performance with collision risk, exceptions, and driver rankings",fe="safety",be="IconShield",xe=53334,ye=["safety","risk","exceptions","drivers","AI"],we=["ViewCollisionRisk","ViewExceptions","ViewDrivers"],je=[{id:"collision-risk-overview",type:"overview-card",title:"Average Collision Risk Score",description:"Fleet-wide collision risk based on AI model",icon:"IconAlert",dataSource:{apiEntity:"CollisionRiskAnalytics",aggregationParams:{groupBy:["database"],aggregations:[{op:"avg",field:"score",alias:"avgScore"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:0,width:4},configurable:!1,required:!0,options:{trendConfig:{comparisonPeriod:"7d",showPercentage:!0,showArrow:!0}}},{id:"safety-alerts",type:"immediate-actions",title:"Safety Alerts",description:"Critical safety items requiring attention",icon:"IconWarning",dataSource:{apiEntity:"ExceptionEvent",filters:[{field:"severity",operator:"IN",value:["Critical","High"]}],dateRangeEnabled:!0,groupFilterEnabled:!0,resultsLimit:100},defaultPosition:{row:1,column:0,width:12},configurable:!1,required:!0,options:{navigationConfig:[{id:"critical-exceptions",label:"Critical Exceptions",pageName:"exception",pageState:{severity:["Critical"]}},{id:"high-risk-drivers",label:"High-Risk Drivers",pageName:"riskManagement",pageState:{sortBy:"riskScore",sortDirection:"desc"}}]}},{id:"collision-risk-benchmark",type:"benchmark-bar",title:"Collision Risk vs Industry",description:"Compare your fleet's risk score to industry average",icon:"IconTrendingUp",dataSource:{apiEntity:"CollisionRiskAnalytics",aggregationParams:{aggregations:[{op:"avg",field:"score"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:4,width:4},configurable:!1,options:{benchmarkValue:65}},{id:"safety-metrics-trend",type:"metric-chart",title:"Safety Metrics",description:"Track safety performance over time",icon:"IconChartLine",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*",alias:"exceptionCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"statusDate",sortDirection:"asc"}},defaultPosition:{row:2,column:0,width:12},configurable:!0,options:{availableMetrics:[{id:"exception-count",label:"Exception Count",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"harsh-events",label:"Harsh Events",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*"}]},filters:[{field:"rule.name",operator:"IN",value:["Harsh Braking","Harsh Acceleration","Harsh Cornering"]}],dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"collision-risk-score",label:"Collision Risk Score",dataSource:{apiEntity:"CollisionRiskAnalytics",aggregationParams:{groupBy:["dateCalculated"],aggregations:[{op:"avg",field:"score"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}}]}},{id:"highest-risk-drivers",type:"performance-rankings",title:"Highest Risk Drivers",description:"Drivers with most safety exceptions",icon:"IconUser",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"exceptionCount"},{op:"sum",field:"severity",alias:"totalSeverity"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"totalSeverity",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:0,column:8,width:4},configurable:!0,options:{rankingLimit:10}}],Ne=[{id:"exception-types-breakdown",type:"overview-card",title:"Exception Types",description:"Breakdown of exceptions by type",icon:"IconPieChart",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["rule.name"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:3,column:0,width:6},configurable:!0},{id:"safest-drivers",type:"performance-rankings",title:"Safest Drivers",description:"Drivers with fewest exceptions",icon:"IconTrophy",dataSource:{apiEntity:"ExceptionEvent",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"exceptionCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"exceptionCount",sortDirection:"asc"},resultsLimit:10},defaultPosition:{row:3,column:6,width:6},configurable:!0,options:{rankingLimit:10}}],ke={id:pe,name:ve,description:_e,category:fe,icon:be,estimatedUsers:xe,tags:ye,requiredPermissions:we,defaultModules:je,availableModules:Ne},Se="maintenance-overview",Ee="Maintenance Overview",Ce="Track maintenance operations, predict breakdowns, and manage work orders",De="maintenance",Pe="IconTool",Me=68977,Re=["maintenance","work orders","faults","downtime","predictive"],Le=["ViewMaintenanceWorkOrders","ViewMaintenanceWorkRequests","ViewFaults","ViewMaintenanceOverview"],Ae=[{id:"immediate-actions",type:"immediate-actions",title:"Immediate Actions",description:"Critical maintenance items requiring attention",icon:"IconAlert",dataSource:{apiEntity:"MaintenanceWorkRequestEntity",filters:[],dateRangeEnabled:!0,groupFilterEnabled:!0,resultsLimit:100},defaultPosition:{row:0,column:0,width:12},configurable:!1,required:!0,options:{navigationConfig:[{id:"severe-work-requests",label:"Severe Work Requests",pageName:"maintenanceWorkRequests",pageState:{severities:["Critical","High"],isReviewed:!1}},{id:"severe-faults",label:"Severe Faults (Last 7 Days)",pageName:"faults",pageState:{severities:["Critical","High"],daysBack:7}},{id:"extended-downtime",label:"Vehicles with Extended Downtime",pageName:"vehicleDowntime",pageState:{minDays:14}}]}},{id:"maintenance-metrics",type:"metric-chart",title:"Maintenance Metrics",description:"Track maintenance performance over time",icon:"IconChartLine",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["completedDate"],aggregations:[{op:"count",field:"*",alias:"workOrderCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"completedDate",sortDirection:"asc"}},defaultPosition:{row:1,column:0,width:12},configurable:!0,options:{availableMetrics:[{id:"work-orders-completed",label:"Work Orders Completed",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["completedDate"],aggregations:[{op:"count",field:"*"}]},filters:[{field:"status",operator:"IN",value:["Closed","Completed"]}],dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"work-requests-created",label:"Work Requests Created",dataSource:{apiEntity:"MaintenanceWorkRequestEntity",aggregationParams:{groupBy:["statusDate"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"breakdown-rate",label:"Breakdown Rate",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"downtime-hours",label:"Downtime Hours",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["date"],aggregations:[{op:"sum",field:"downtimeSeconds"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}}]}},{id:"highest-risk-breakdown",type:"performance-rankings",title:"Highest Risk of Breakdown",description:"Assets most likely to break down",icon:"IconWarning",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["device"],aggregations:[{op:"count",field:"*",alias:"breakdownCount"},{op:"sum",field:"downtimeSeconds",alias:"totalDowntime"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"breakdownCount",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:2,column:0,width:6},configurable:!0,options:{rankingLimit:10}},{id:"performance-insights",type:"performance-rankings",title:"Performance Insights",description:"Asset and group maintenance performance",icon:"IconChartBar",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["device"],aggregations:[{op:"count",field:"*",alias:"workOrderCount"},{op:"sum",field:"totalCosts",alias:"totalCost"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"workOrderCount",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:2,column:6,width:6},configurable:!0,options:{rankingLimit:10}}],Ie=[{id:"total-work-orders",type:"overview-card",title:"Total Work Orders",description:"Work orders completed this period",icon:"IconClipboard",dataSource:{apiEntity:"MaintenanceWorkOrderEntity",aggregationParams:{groupBy:["database"],aggregations:[{op:"count",field:"*",alias:"totalCount"}]},filters:[{field:"status",operator:"IN",value:["Closed","Completed"]}],dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:0,width:4},configurable:!0,options:{trendConfig:{comparisonPeriod:"30d",showPercentage:!0,showArrow:!0}}},{id:"average-downtime",type:"overview-card",title:"Average Downtime",description:"Average downtime per vehicle",icon:"IconClock",dataSource:{apiEntity:"VehicleDowntimeEntity",aggregationParams:{groupBy:["database"],aggregations:[{op:"avg",field:"downtimeSeconds",alias:"avgDowntime"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:4,width:4},configurable:!0,options:{trendConfig:{comparisonPeriod:"30d",showPercentage:!0,showArrow:!0}}},{id:"fault-breakdown",type:"overview-card",title:"Fault Types",description:"Breakdown of faults by severity",icon:"IconPieChart",dataSource:{apiEntity:"FaultDataEntity",aggregationParams:{groupBy:["severity"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:3,column:0,width:6},configurable:!0}],Be={id:Se,name:Ee,description:Ce,category:De,icon:Pe,estimatedUsers:Me,tags:Re,requiredPermissions:Le,defaultModules:Ae,availableModules:Ie},Oe="compliance-dashboard",Fe="Compliance Dashboard",Te="Monitor HOS compliance, manage violations, and track driver availability",Ve="compliance",$e="IconShieldCheck",qe=133722,Ue=["HOS","compliance","violations","drivers","IFTA","ELD"],We=["ViewHoSLogs","ViewDutyStatusViolations","ViewIftaMiles"],He=[{id:"compliance-status",type:"overview-card",title:"Active Violations",description:"Drivers with current HOS violations",icon:"IconAlertTriangle",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["database"],aggregations:[{op:"count",field:"*",alias:"violationCount"}]},filters:[{field:"isActive",operator:"=",value:!0}],dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:0,width:4},configurable:!1,required:!0,options:{trendConfig:{comparisonPeriod:"7d",showPercentage:!0,showArrow:!0}}},{id:"driver-availability",type:"overview-card",title:"Available Drivers",description:"Drivers with sufficient hours remaining",icon:"IconUsers",dataSource:{apiEntity:"DutyStatusAvailability",aggregationParams:{groupBy:["database"],aggregations:[{op:"count",field:"*",alias:"availableCount"}]},filters:[{field:"drivingHoursRemaining",operator:">=",value:4}],dateRangeEnabled:!1,groupFilterEnabled:!0},defaultPosition:{row:0,column:4,width:4},configurable:!1,required:!0,options:{trendConfig:{comparisonPeriod:"7d",showPercentage:!0,showArrow:!0}}},{id:"ifta-summary",type:"overview-card",title:"IFTA Miles (Current Quarter)",description:"Total miles by jurisdiction",icon:"IconMap",dataSource:{apiEntity:"IftaDetail",aggregationParams:{groupBy:["database"],aggregations:[{op:"sum",field:"totalMiles",alias:"totalMiles"},{op:"sum",field:"fuelConsumed",alias:"totalFuel"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:0,column:8,width:4},configurable:!0,options:{trendConfig:{comparisonPeriod:"90d",showPercentage:!0,showArrow:!1}}},{id:"critical-violations",type:"immediate-actions",title:"Critical Violations",description:"HOS violations requiring immediate attention",icon:"IconAlert",dataSource:{apiEntity:"DutyStatusViolation",filters:[{field:"isActive",operator:"=",value:!0},{field:"severity",operator:"IN",value:["Critical","High"]}],dateRangeEnabled:!0,groupFilterEnabled:!0,resultsLimit:100},defaultPosition:{row:1,column:0,width:12},configurable:!1,required:!0,options:{navigationConfig:[{id:"active-violations",label:"Active Violations",pageName:"hosViolations",pageState:{isActive:!0,severity:["Critical","High"]}},{id:"approaching-limits",label:"Drivers Approaching Limits",pageName:"hosAvailability",pageState:{hoursRemaining:{max:2}}},{id:"missing-logs",label:"Missing Logs",pageName:"hosLogs",pageState:{hasCertified:!1,daysBack:7}}]}},{id:"violation-trend",type:"metric-chart",title:"Compliance Metrics",description:"Track compliance performance over time",icon:"IconChartLine",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*",alias:"violationCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"date",sortDirection:"asc"}},defaultPosition:{row:2,column:0,width:12},configurable:!0,options:{availableMetrics:[{id:"violation-count",label:"Violation Count",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"available-hours",label:"Average Available Hours",dataSource:{apiEntity:"DutyStatusAvailability",aggregationParams:{groupBy:["date"],aggregations:[{op:"avg",field:"drivingHoursRemaining"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}},{id:"log-completeness",label:"Log Completeness %",dataSource:{apiEntity:"DutyStatusLog",aggregationParams:{groupBy:["date"],aggregations:[{op:"count",field:"*",alias:"totalLogs"},{op:"count",field:"hasCertified",alias:"certifiedLogs",where:"hasCertified = true"}]},dateRangeEnabled:!0,groupFilterEnabled:!0}}]}},{id:"top-violators",type:"performance-rankings",title:"Top Violators",description:"Drivers with most violations",icon:"IconUser",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"violationCount"},{op:"count",field:"severity",alias:"criticalCount",where:"severity = 'Critical'"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"violationCount",sortDirection:"desc"},resultsLimit:10},defaultPosition:{row:3,column:0,width:6},configurable:!0,options:{rankingLimit:10}}],ze=[{id:"compliant-drivers",type:"performance-rankings",title:"Most Compliant Drivers",description:"Drivers with fewest violations",icon:"IconTrophy",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["driver"],aggregations:[{op:"count",field:"*",alias:"violationCount"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"violationCount",sortDirection:"asc"},resultsLimit:10},defaultPosition:{row:3,column:6,width:6},configurable:!0,options:{rankingLimit:10}},{id:"violation-types",type:"overview-card",title:"Violation Types Breakdown",description:"Distribution of violations by type",icon:"IconPieChart",dataSource:{apiEntity:"DutyStatusViolation",aggregationParams:{groupBy:["violationType"],aggregations:[{op:"count",field:"*"}]},dateRangeEnabled:!0,groupFilterEnabled:!0},defaultPosition:{row:4,column:0,width:6},configurable:!0},{id:"jurisdiction-miles",type:"performance-rankings",title:"Miles by Jurisdiction",description:"IFTA miles breakdown by state/province",icon:"IconMap",dataSource:{apiEntity:"IftaDetail",aggregationParams:{groupBy:["jurisdiction"],aggregations:[{op:"sum",field:"totalMiles",alias:"miles"},{op:"sum",field:"fuelConsumed",alias:"fuel"}]},dateRangeEnabled:!0,groupFilterEnabled:!0,sort:{sortBy:"miles",sortDirection:"desc"},resultsLimit:15},defaultPosition:{row:4,column:6,width:6},configurable:!0,options:{rankingLimit:15}}],Ge={id:Oe,name:Fe,description:Te,category:Ve,icon:$e,estimatedUsers:qe,tags:Ue,requiredPermissions:We,defaultModules:He,availableModules:ze};class Je{constructor(){C(this,"recipes");this.recipes=[ke,Be,Ge]}async loadRecipes(){return Promise.resolve(this.recipes)}getRecipeById(a){return this.recipes.find(r=>r.id===a)}filterByCategory(a){return this.recipes.filter(r=>r.category===a)}search(a){if(!a||a.trim()==="")return this.recipes;const r=a.toLowerCase();return this.recipes.filter(i=>{var s;return i.name.toLowerCase().includes(r)||i.description.toLowerCase().includes(r)||((s=i.tags)==null?void 0:s.some(n=>n.toLowerCase().includes(r)))})}getCategories(){const a=this.recipes.map(r=>r.category);return Array.from(new Set(a))}sortByPopularity(a){return[...a].sort((r,i)=>(i.estimatedUsers||0)-(r.estimatedUsers||0))}}const D=new Je;function Ye(t,a){const[r,i]=u.useState([]),[s,n]=u.useState([]),[o,l]=u.useState(!0),[c,d]=u.useState(null),{hasPermissions:h}=ge();return u.useEffect(()=>{async function m(){try{l(!0);const _=(await D.loadRecipes()).filter(b=>h(b.requiredPermissions));i(_);let f=_;t&&(f=f.filter(b=>b.category===t)),a&&(f=D.search(a)),f=D.sortByPopularity(f),n(f)}catch(p){d(p)}finally{l(!1)}}m()},[t,a]),{recipes:r,filteredRecipes:s,loading:o,error:c}}const q=u.createContext(void 0);function Qe({children:t}){const{recipes:a,filteredRecipes:r,loading:i,error:s}=Ye();return e.jsx(q.Provider,{value:{recipes:a,filteredRecipes:r,loading:i,error:s},children:t})}function Xe(){const t=u.useContext(q);if(!t)throw new Error("useRecipeContext must be used within RecipeProvider");return t}const U={step:"recipe-picker",selectedModules:[],selectedLayout:"grid",isSaved:!1};function Ke(t,a){switch(a.type){case"SELECT_RECIPE":return{...t,selectedRecipe:a.payload,selectedModules:a.payload.defaultModules,step:"module-selector"};case"UPDATE_MODULES":return{...t,selectedModules:a.payload};case"SELECT_LAYOUT":return{...t,selectedLayout:a.payload};case"NEXT_STEP":const r=["recipe-picker","module-selector","layout-selector","preview","save"],i=r.indexOf(t.step),s=r[Math.min(i+1,r.length-1)];return{...t,step:s};case"PREV_STEP":const n=["recipe-picker","module-selector","layout-selector","preview","save"],o=n.indexOf(t.step),l=n[Math.max(o-1,0)];return{...t,step:l};case"GO_TO_STEP":return{...t,step:a.payload};case"SAVE_SUCCESS":return{...t,isSaved:!0,savedDashboardId:a.payload};case"RESET":return U;default:return t}}const W=u.createContext(void 0);function Ze({children:t}){const[a,r]=u.useReducer(Ke,U);return e.jsx(W.Provider,{value:{state:a,dispatch:r},children:t})}function y(){const t=u.useContext(W);if(!t)throw new Error("useDashboardContext must be used within DashboardProvider");return t}class ea extends u.Component{constructor(r){super(r);C(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,i){console.error("ErrorBoundary caught error:",r,i),this.setState({error:r,errorInfo:i})}render(){var r;return this.state.hasError?e.jsx("div",{className:"error-boundary",children:e.jsxs("div",{className:"error-boundary__content",children:[e.jsx("div",{className:"error-boundary__icon",children:"âš ï¸"}),e.jsx("h2",{className:"error-boundary__title",children:"Something went wrong"}),e.jsx("p",{className:"error-boundary__message",children:((r=this.state.error)==null?void 0:r.message)||"An unexpected error occurred"}),!1,e.jsx("button",{className:"error-boundary__button",onClick:this.handleReset,children:"Try Again"})]})}):this.props.children}}function aa({current:t,total:a,showLabels:r=!0}){const i=t/a*100;return e.jsxs("div",{className:"progress-bar",children:[e.jsx("div",{className:"progress-bar__track",children:e.jsx("div",{className:"progress-bar__fill",style:{width:`${i}%`}})}),r&&e.jsxs("div",{className:"progress-bar__label",children:["Step ",t," of ",a]})]})}function x({message:t="Loading...",size:a="medium"}){return e.jsxs("div",{className:`loading-state loading-state--${a}`,children:[e.jsx("div",{className:"loading-state__spinner",children:e.jsx("div",{className:"spinner"})}),t&&e.jsx("p",{className:"loading-state__message",children:t})]})}function ta(){const{dispatch:t}=y(),{recipes:a,loading:r,error:i}=Xe(),[s,n]=u.useState(""),[o,l]=u.useState("all"),c=a.filter(m=>{const p=!s||m.name.toLowerCase().includes(s.toLowerCase())||m.description.toLowerCase().includes(s.toLowerCase()),_=o==="all"||m.category===o;return p&&_}),d=m=>{t({type:"SELECT_RECIPE",payload:m})},h=()=>{console.log("Create custom dashboard")};return r?e.jsx(x,{message:"Loading recipes..."}):i?e.jsx("div",{className:"recipe-picker__error",children:e.jsxs("p",{children:["Error loading recipes: ",i.message]})}):e.jsxs("div",{className:"recipe-picker",children:[e.jsxs("div",{className:"recipe-picker__header",children:[e.jsx("h2",{className:"recipe-picker__title",children:"What would you like to track?"}),e.jsx("p",{className:"recipe-picker__subtitle",children:"Choose a pre-built recipe or start from scratch"})]}),e.jsxs("div",{className:"recipe-picker__filters",children:[e.jsx("input",{type:"text",className:"recipe-picker__search",placeholder:"Search recipes...",value:s,onChange:m=>n(m.target.value)}),e.jsxs("select",{className:"recipe-picker__category",value:o,onChange:m=>l(m.target.value),children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"safety",children:"Safety"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"compliance",children:"Compliance"}),e.jsx("option",{value:"operations",children:"Operations"}),e.jsx("option",{value:"fuel",children:"Fuel"})]})]}),e.jsxs("div",{className:"recipe-picker__grid",children:[c.map(m=>{var p;return e.jsxs("div",{className:"recipe-card",onClick:()=>d(m),children:[e.jsx("div",{className:"recipe-card__icon",children:m.icon}),e.jsx("h3",{className:"recipe-card__name",children:m.name}),e.jsx("p",{className:"recipe-card__description",children:m.description}),m.estimatedUsers&&e.jsxs("div",{className:"recipe-card__users",children:[m.estimatedUsers.toLocaleString(),"+ users"]}),e.jsx("div",{className:"recipe-card__tags",children:(p=m.tags)==null?void 0:p.slice(0,3).map(_=>e.jsx("span",{className:"recipe-card__tag",children:_},_))}),e.jsx("button",{className:"recipe-card__button",children:"Select"})]},m.id)}),e.jsxs("div",{className:"recipe-card recipe-card--custom",onClick:h,children:[e.jsx("div",{className:"recipe-card__icon",children:"+"}),e.jsx("h3",{className:"recipe-card__name",children:"Start from Scratch"}),e.jsx("p",{className:"recipe-card__description",children:"Build a custom dashboard with your own modules"}),e.jsx("button",{className:"recipe-card__button",children:"Create Custom"})]})]}),e.jsx("div",{className:"recipe-picker__tip",children:"ðŸ’¡ Tip: Recipes come pre-configured with proven insights. You can customize them in the next step."})]})}function R({onBack:t,onNext:a,canGoBack:r=!0,canGoNext:i=!0,nextLabel:s="Continue",backLabel:n="Back"}){return e.jsxs("div",{className:"step-navigation",children:[e.jsx("div",{className:"step-navigation__left",children:t&&e.jsxs("button",{className:"step-navigation__button step-navigation__button--back",onClick:t,disabled:!r,children:["â† ",n]})}),e.jsx("div",{className:"step-navigation__right",children:a&&e.jsxs("button",{className:"step-navigation__button step-navigation__button--next",onClick:a,disabled:!i,children:[s," â†’"]})})]})}function ra(){const{state:t,dispatch:a}=y(),{selectedRecipe:r,selectedModules:i}=t;if(!r)return e.jsx("div",{children:"No recipe selected"});const s=c=>i.some(d=>d.id===c),n=c=>{if(c.required&&s(c.id))return;const d=s(c.id)?i.filter(h=>h.id!==c.id):[...i,c];a({type:"UPDATE_MODULES",payload:d})},o=()=>{a({type:"PREV_STEP"})},l=()=>{a({type:"NEXT_STEP"})};return e.jsxs("div",{className:"module-selector",children:[e.jsxs("div",{className:"module-selector__header",children:[e.jsx("h2",{className:"module-selector__title",children:r.name}),e.jsx("p",{className:"module-selector__subtitle",children:"Which insights do you want to include?"})]}),e.jsxs("div",{className:"module-selector__section",children:[e.jsxs("h3",{className:"module-selector__section-title",children:["Included Modules (",i.length,")"]}),e.jsx("div",{className:"module-list",children:r.defaultModules.map(c=>e.jsxs("div",{className:`module-item ${s(c.id)?"module-item--selected":""}`,children:[e.jsx("input",{type:"checkbox",id:c.id,checked:s(c.id),onChange:()=>n(c),disabled:c.required}),e.jsxs("label",{htmlFor:c.id,className:"module-item__content",children:[e.jsxs("div",{className:"module-item__header",children:[e.jsx("span",{className:"module-item__name",children:c.title}),c.required&&e.jsx("span",{className:"module-item__badge",children:"Required"})]}),e.jsx("p",{className:"module-item__description",children:c.description})]})]},c.id))})]}),r.availableModules.length>0&&e.jsxs("div",{className:"module-selector__section",children:[e.jsxs("h3",{className:"module-selector__section-title",children:["Available Modules (",r.availableModules.length,")"]}),e.jsx("div",{className:"module-list",children:r.availableModules.map(c=>e.jsxs("div",{className:`module-item ${s(c.id)?"module-item--selected":""}`,children:[e.jsx("input",{type:"checkbox",id:c.id,checked:s(c.id),onChange:()=>n(c)}),e.jsxs("label",{htmlFor:c.id,className:"module-item__content",children:[e.jsx("div",{className:"module-item__header",children:e.jsx("span",{className:"module-item__name",children:c.title})}),e.jsx("p",{className:"module-item__description",children:c.description})]})]},c.id))})]}),e.jsx("div",{className:"module-selector__tip",children:"ðŸ’¡ Tip: You can drag to reorder modules in the next step"}),e.jsx(R,{onBack:o,onNext:l,canGoNext:i.length>0})]})}function L(t,a){switch(a){case"single-column":return ia(t);case"two-column":return sa(t);case"grid":return na(t);default:return t}}function ia(t){return t.map((a,r)=>({...a,defaultPosition:{row:r,column:0,width:12}}))}function sa(t){return t.map((a,r)=>{const i=r%2===0,s=Math.floor(r/2);return{...a,defaultPosition:{row:s,column:i?0:6,width:6}}})}function na(t){let a=0,r=0;return t.map((i,s)=>{const n=s<3?4:6,o={row:a,column:r,width:n};return r+=n,r>=12&&(r=0,a++),{...i,defaultPosition:o}})}function oa(t){return t<=3?"single-column":t<=6?"two-column":"grid"}function ca(t){return{"single-column":"Single Column","two-column":"Two Column",grid:"Grid"}[t]}function la(t){return{"single-column":"Best for mobile or narrow screens","two-column":"Best for desktop screens",grid:"Best for wide desktop screens"}[t]}function da(){const{state:t,dispatch:a}=y(),{selectedModules:r,selectedLayout:i}=t,s=oa(r.length),n=["single-column","two-column","grid"],o=d=>{a({type:"SELECT_LAYOUT",payload:d})},l=()=>{a({type:"PREV_STEP"})},c=()=>{a({type:"NEXT_STEP"})};return e.jsxs("div",{className:"layout-selector",children:[e.jsx("div",{className:"layout-selector__header",children:e.jsx("h2",{className:"layout-selector__title",children:"How would you like to arrange your dashboard?"})}),e.jsx("div",{className:"layout-selector__grid",children:n.map(d=>e.jsxs("div",{className:`layout-card ${i===d?"layout-card--selected":""}`,onClick:()=>o(d),children:[e.jsxs("div",{className:"layout-card__preview",children:[d==="single-column"&&e.jsxs("div",{className:"layout-preview layout-preview--single",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),d==="two-column"&&e.jsxs("div",{className:"layout-preview layout-preview--two",children:[e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsx("div",{className:"layout-preview__item layout-preview__item--full"})]}),d==="grid"&&e.jsxs("div",{className:"layout-preview layout-preview--grid",children:[e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsxs("div",{className:"layout-preview__row",children:[e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"}),e.jsx("div",{className:"layout-preview__item"})]}),e.jsx("div",{className:"layout-preview__item layout-preview__item--full"})]})]}),e.jsxs("h3",{className:"layout-card__name",children:[ca(d),d===s&&e.jsx("span",{className:"layout-card__badge",children:"Recommended"})]}),e.jsx("p",{className:"layout-card__description",children:la(d)}),e.jsx("button",{className:`layout-card__button ${i===d?"layout-card__button--selected":""}`,children:i===d?"âœ“ Selected":"Select"})]},d))}),e.jsx(R,{onBack:l,onNext:c,nextLabel:"Preview"})]})}function H(t="score"){switch(t){case"score":return Math.floor(Math.random()*100);case"count":return Math.floor(Math.random()*50);case"percentage":return Math.floor(Math.random()*100);default:return 0}}function ua(){const t=Math.floor(Math.random()*20)-10;return{value:H("score"),change:Math.abs(t),direction:t>=0?"up":"down"}}function ma(t=30){const a=[],r=new Date;for(let i=t-1;i>=0;i--){const s=new Date(r);s.setDate(s.getDate()-i),a.push({date:s.toISOString().split("T")[0],value:Math.floor(Math.random()*100)+20})}return a}function ha(t=10){return["John Smith","Jane Doe","Bob Johnson","Alice Williams","Charlie Brown","Diana Prince","Eve Anderson","Frank Miller","Grace Lee","Henry Davis","Ivy Chen","Jack Wilson"].slice(0,t).map((r,i)=>({id:`driver-${i+1}`,name:r,value:Math.floor(Math.random()*30)+5,score:100-i*5-Math.floor(Math.random()*5)}))}function ga(t=3){return[{title:"Critical Exceptions",severity:"critical"},{title:"High-Risk Drivers",severity:"high"},{title:"Vehicles Needing Attention",severity:"medium"},{title:"Severe Work Requests",severity:"critical"},{title:"Active Violations",severity:"high"},{title:"Missing Logs",severity:"medium"}].slice(0,t).map((r,i)=>({id:`alert-${i+1}`,title:r.title,count:Math.floor(Math.random()*15)+1,severity:r.severity}))}function pa(){const t=Math.floor(Math.random()*40)+40;return{fleetScore:t,industryAverage:65,percentile:Math.floor(t/100*100)}}function z(){return localStorage.getItem("overviewBuilder.useMockData")!=="false"}function va(t){localStorage.setItem("overviewBuilder.useMockData",String(t))}class _a{async fetchModuleData(a,r,i,s,n){return z()?this.fetchMockData(i):this.fetchRealData(a,r,i,s,n)}async fetchMockData(a){switch(await new Promise(r=>setTimeout(r,500)),a.type){case"overview-card":return{metric:H("score"),...ua()};case"immediate-actions":return{alerts:ga(3)};case"metric-chart":return{series:ma(30)};case"performance-rankings":return{rankings:ha(10)};case"benchmark-bar":return pa();default:return{}}}async fetchRealData(a,r,i,s,n){const{dataSource:o}=i;try{const l={};return o.dateRangeEnabled&&s&&(l.fromDate=s.start,l.toDate=s.end),o.groupFilterEnabled&&n&&(l.groupFilterCondition=n),o.filters&&o.filters.forEach(c=>{l[c.field]=c.value}),o.aggregationParams?await this.callAggregationAPI(a,r,o.apiEntity,o.aggregationParams,l,o.sort,o.resultsLimit):await this.callGetAPI(a,r,o.apiEntity,l,o.sort,o.resultsLimit)}catch(l){throw console.error("Error fetching module data:",l),l}}async callAggregationAPI(a,r,i,s,n,o,l){return console.log("Calling aggregation API:",{entityType:i,aggregationParams:s,search:n,sort:o,limit:l}),this.fetchMockData({type:"metric-chart"})}async callGetAPI(a,r,i,s,n,o){return console.log("Calling Get API:",{entityType:i,search:s,sort:n,limit:o}),this.fetchMockData({type:"immediate-actions"})}}const fa=new _a;function w(t,a,r,i=!0){const{api:s,credentials:n}=M();return te({queryKey:["module-data",t.id,a,r],queryFn:()=>fa.fetchModuleData(s,n,t,a,r),enabled:i&&!!s&&!!t,staleTime:5*60*1e3,retry:1})}function ba({module:t,useLiveData:a=!1}){const{data:r,isLoading:i,error:s}=w(t,void 0,void 0,a);if(i)return e.jsx("div",{className:"overview-card",children:e.jsx(x,{size:"small",message:""})});if(s)return e.jsx("div",{className:"overview-card overview-card--error",children:e.jsx("div",{className:"overview-card__error",children:"Error loading data"})});const n=(r==null?void 0:r.metric)||0,o=(r==null?void 0:r.change)||0,l=(r==null?void 0:r.direction)||"up";return e.jsxs("div",{className:"overview-card",children:[t.icon&&e.jsx("div",{className:"overview-card__icon",children:t.icon}),e.jsxs("div",{className:"overview-card__content",children:[e.jsx("div",{className:"overview-card__header",children:e.jsx("h3",{className:"overview-card__title",children:t.title})}),t.description&&e.jsx("p",{className:"overview-card__description",children:t.description}),e.jsx("div",{className:"overview-card__metric",children:e.jsx("span",{className:"overview-card__value",children:n})}),o!==0&&e.jsxs("div",{className:`overview-card__trend overview-card__trend--${l}`,children:[e.jsx("span",{className:"overview-card__trend-icon",children:l==="up"?"â†‘":"â†“"}),e.jsxs("span",{className:"overview-card__trend-value",children:[Math.abs(o),"%"]})]})]})]})}function xa({module:t,useLiveData:a=!1}){var l;const{data:r,isLoading:i,error:s}=w(t,void 0,void 0,a);if(i)return e.jsx("div",{className:"immediate-actions",children:e.jsx(x,{size:"small",message:"Loading actions..."})});if(s)return e.jsx("div",{className:"immediate-actions immediate-actions--error",children:e.jsx("div",{className:"immediate-actions__error",children:"Error loading actions"})});const n=(r==null?void 0:r.alerts)||[],o=((l=t.options)==null?void 0:l.navigationConfig)||[];return e.jsxs("div",{className:"immediate-actions",children:[e.jsxs("div",{className:"immediate-actions__header",children:[e.jsx("h3",{className:"immediate-actions__title",children:t.title}),t.description&&e.jsx("p",{className:"immediate-actions__description",children:t.description})]}),e.jsx("div",{className:"immediate-actions__list",children:n.length===0?e.jsx("div",{className:"immediate-actions__empty",children:"âœ“ No items requiring immediate attention"}):n.map((c,d)=>e.jsxs("div",{className:`immediate-actions__item immediate-actions__item--${c.severity}`,children:[e.jsxs("div",{className:"immediate-actions__item-header",children:[e.jsx("span",{className:"immediate-actions__item-title",children:c.title}),e.jsx("span",{className:"immediate-actions__item-count",children:c.count})]}),o[d]&&e.jsx("button",{className:"immediate-actions__item-link",children:"View Details â†’"})]},d))}),o.length>0&&e.jsx("div",{className:"immediate-actions__footer",children:o.map(c=>e.jsx("button",{className:"immediate-actions__quick-link",children:c.label},c.id))})]})}function ya({module:t,useLiveData:a=!1}){var d;const r=((d=t.options)==null?void 0:d.availableMetrics)||[],[i,s]=u.useState(0),{data:n,isLoading:o,error:l}=w(t,void 0,void 0,a);if(o)return e.jsx("div",{className:"metric-chart",children:e.jsx(x,{size:"small",message:"Loading chart..."})});if(l)return e.jsx("div",{className:"metric-chart metric-chart--error",children:e.jsx("div",{className:"metric-chart__error",children:"Error loading chart"})});const c=(n==null?void 0:n.series)||[];return e.jsxs("div",{className:"metric-chart",children:[e.jsxs("div",{className:"metric-chart__header",children:[e.jsx("h3",{className:"metric-chart__title",children:t.title}),r.length>0&&e.jsx("select",{className:"metric-chart__selector",value:i,onChange:h=>s(Number(h.target.value)),children:r.map((h,m)=>e.jsx("option",{value:m,children:h.label},h.id))})]}),e.jsx("div",{className:"metric-chart__chart",children:c.length===0?e.jsx("div",{className:"metric-chart__empty",children:"No data available"}):e.jsx("div",{className:"metric-chart__visualization",children:e.jsx("div",{className:"metric-chart__bars",children:c.slice(-10).map((h,m)=>{const p=Math.max(...c.map(f=>f.value)),_=h.value/p*100;return e.jsxs("div",{className:"metric-chart__bar-wrapper",children:[e.jsx("div",{className:"metric-chart__bar",style:{height:`${_}%`},title:`${h.date}: ${h.value}`}),e.jsx("div",{className:"metric-chart__bar-label",children:new Date(h.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]},m)})})})})]})}function wa({module:t,useLiveData:a=!1}){var l;const{data:r,isLoading:i,error:s}=w(t,void 0,void 0,a);if(i)return e.jsx("div",{className:"performance-rankings",children:e.jsx(x,{size:"small",message:"Loading rankings..."})});if(s)return e.jsx("div",{className:"performance-rankings performance-rankings--error",children:e.jsx("div",{className:"performance-rankings__error",children:"Error loading rankings"})});const n=(r==null?void 0:r.rankings)||[],o=((l=t.options)==null?void 0:l.rankingLimit)||10;return e.jsxs("div",{className:"performance-rankings",children:[e.jsxs("div",{className:"performance-rankings__header",children:[e.jsx("h3",{className:"performance-rankings__title",children:t.title}),t.description&&e.jsx("p",{className:"performance-rankings__description",children:t.description})]}),e.jsx("div",{className:"performance-rankings__list",children:n.length===0?e.jsx("div",{className:"performance-rankings__empty",children:"No data available"}):n.slice(0,o).map((c,d)=>e.jsxs("div",{className:"performance-rankings__item",children:[e.jsxs("div",{className:"performance-rankings__rank",children:["#",d+1]}),e.jsxs("div",{className:"performance-rankings__content",children:[e.jsx("div",{className:"performance-rankings__name",children:c.name}),e.jsxs("div",{className:"performance-rankings__details",children:[e.jsx("span",{className:"performance-rankings__value",children:c.value}),c.score&&e.jsxs("span",{className:"performance-rankings__score",children:["Score: ",c.score]})]})]}),e.jsx("button",{className:"performance-rankings__link",children:"â†’"})]},c.id))}),n.length>o&&e.jsx("div",{className:"performance-rankings__footer",children:e.jsxs("button",{className:"performance-rankings__view-all",children:["View All (",n.length,")"]})})]})}function ja({module:t,useLiveData:a=!1}){var h;const{data:r,isLoading:i,error:s}=w(t,void 0,void 0,a);if(i)return e.jsx("div",{className:"benchmark-bar",children:e.jsx(x,{size:"small",message:"Loading benchmark..."})});if(s)return e.jsx("div",{className:"benchmark-bar benchmark-bar--error",children:e.jsx("div",{className:"benchmark-bar__error",children:"Error loading benchmark"})});const n=(r==null?void 0:r.fleetScore)||0,o=(r==null?void 0:r.industryAverage)||((h=t.options)==null?void 0:h.benchmarkValue)||65,l=(r==null?void 0:r.percentile)||50,d=(()=>n>=o+10?"good":n>=o-10?"average":"below")();return e.jsxs("div",{className:"benchmark-bar",children:[e.jsxs("div",{className:"benchmark-bar__header",children:[e.jsx("h3",{className:"benchmark-bar__title",children:t.title}),t.description&&e.jsx("p",{className:"benchmark-bar__description",children:t.description})]}),e.jsxs("div",{className:"benchmark-bar__content",children:[e.jsxs("div",{className:"benchmark-bar__scores",children:[e.jsxs("div",{className:"benchmark-bar__score",children:[e.jsx("div",{className:"benchmark-bar__score-label",children:"Your Fleet"}),e.jsx("div",{className:"benchmark-bar__score-value benchmark-bar__score-value--fleet",children:n})]}),e.jsxs("div",{className:"benchmark-bar__score",children:[e.jsx("div",{className:"benchmark-bar__score-label",children:"Industry Average"}),e.jsx("div",{className:"benchmark-bar__score-value benchmark-bar__score-value--industry",children:o})]})]}),e.jsxs("div",{className:"benchmark-bar__visualization",children:[e.jsxs("div",{className:"benchmark-bar__track",children:[e.jsx("div",{className:`benchmark-bar__fill benchmark-bar__fill--${d}`,style:{width:`${n}%`}}),e.jsx("div",{className:"benchmark-bar__marker",style:{left:`${o}%`},title:`Industry Average: ${o}`})]}),e.jsxs("div",{className:"benchmark-bar__labels",children:[e.jsx("span",{children:"0"}),e.jsx("span",{children:"50"}),e.jsx("span",{children:"100"})]})]}),e.jsxs("div",{className:"benchmark-bar__status",children:[d==="good"&&e.jsxs("div",{className:"benchmark-bar__message benchmark-bar__message--good",children:["âœ“ Above industry average (",l,"th percentile)"]}),d==="average"&&e.jsxs("div",{className:"benchmark-bar__message benchmark-bar__message--average",children:["â‰ˆ Near industry average (",l,"th percentile)"]}),d==="below"&&e.jsxs("div",{className:"benchmark-bar__message benchmark-bar__message--below",children:["âš  Below industry average (",l,"th percentile)"]})]})]})]})}function A({module:t,useLiveData:a=!1}){switch(t.type){case"overview-card":return e.jsx(ba,{module:t,useLiveData:a});case"immediate-actions":return e.jsx(xa,{module:t,useLiveData:a});case"metric-chart":return e.jsx(ya,{module:t,useLiveData:a});case"performance-rankings":return e.jsx(wa,{module:t,useLiveData:a});case"benchmark-bar":return e.jsx(ja,{module:t,useLiveData:a});default:return e.jsxs("div",{className:"module-renderer__unknown",children:["Unknown module type: ",t.type]})}}function O({modules:t,useLiveData:a=!1}){const r=L(t,"grid");return e.jsx("div",{className:"grid-layout",children:r.map(i=>e.jsx("div",{className:"grid-layout__item",style:{gridRow:i.defaultPosition.row+1,gridColumn:`span ${i.defaultPosition.width}`},children:e.jsx(A,{module:i,useLiveData:a})},i.id))})}function Na({modules:t,useLiveData:a=!1}){const r=L(t,"two-column");return e.jsx("div",{className:"two-column-layout",children:r.map(i=>e.jsx("div",{className:"two-column-layout__item",style:{gridRow:i.defaultPosition.row+1,gridColumn:`span ${i.defaultPosition.width}`},children:e.jsx(A,{module:i,useLiveData:a})},i.id))})}function ka({modules:t,useLiveData:a=!1}){const r=L(t,"single-column");return e.jsx("div",{className:"single-column-layout",children:r.map(i=>e.jsx("div",{className:"single-column-layout__item",children:e.jsx(A,{module:i,useLiveData:a})},i.id))})}function Sa(){const{state:t,dispatch:a}=y(),{selectedModules:r,selectedLayout:i,selectedRecipe:s}=t,[n,o]=u.useState(!z()),[l,c]=u.useState("30d"),[d,h]=u.useState("all"),[m,p]=u.useState("5m"),_=g=>{o(g),va(!g)},f=()=>{a({type:"PREV_STEP"})},b=()=>{a({type:"NEXT_STEP"})},k=()=>{const g={modules:r,useLiveData:n};switch(i){case"grid":return e.jsx(O,{...g});case"two-column":return e.jsx(Na,{...g});case"single-column":return e.jsx(ka,{...g});default:return e.jsx(O,{...g})}};return e.jsxs("div",{className:"dashboard-preview",children:[e.jsxs("div",{className:"dashboard-preview__header",children:[e.jsx("h2",{className:"dashboard-preview__title",children:"Preview your dashboard"}),e.jsx("p",{className:"dashboard-preview__subtitle",children:(s==null?void 0:s.name)||"Custom Dashboard"})]}),e.jsxs("div",{className:"dashboard-preview__preview",children:[e.jsx("div",{className:"dashboard-preview__toolbar",children:e.jsxs("div",{className:"dashboard-preview__filters",children:[e.jsxs("select",{value:l,onChange:g=>c(g.target.value),className:"dashboard-preview__filter",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"custom",children:"Custom"})]}),e.jsxs("select",{value:d,onChange:g=>h(g.target.value),className:"dashboard-preview__filter",children:[e.jsx("option",{value:"all",children:"All groups"}),e.jsx("option",{value:"fleet1",children:"Fleet 1"}),e.jsx("option",{value:"fleet2",children:"Fleet 2"})]})]})}),e.jsx("div",{className:"dashboard-preview__content",children:k()}),e.jsxs("div",{className:"dashboard-preview__notice",children:[n?e.jsx("div",{className:"dashboard-preview__info",children:"âœ“ Showing live data"}):e.jsx("div",{className:"dashboard-preview__warning",children:"âš  Showing placeholder data for preview"}),e.jsxs("label",{className:"dashboard-preview__checkbox",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:g=>_(g.target.checked)}),e.jsx("span",{children:"Show live data (this may take a moment)"})]})]})]}),e.jsxs("div",{className:"dashboard-preview__settings",children:[e.jsx("h3",{className:"dashboard-preview__settings-title",children:"Global Settings (Optional)"}),e.jsxs("div",{className:"dashboard-preview__settings-grid",children:[e.jsxs("div",{className:"dashboard-preview__setting",children:[e.jsx("label",{children:"Default Date Range:"}),e.jsxs("select",{value:l,onChange:g=>c(g.target.value),children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"})]})]}),e.jsxs("div",{className:"dashboard-preview__setting",children:[e.jsx("label",{children:"Default Groups:"}),e.jsx("select",{value:d,onChange:g=>h(g.target.value),children:e.jsx("option",{value:"all",children:"All groups"})})]}),e.jsxs("div",{className:"dashboard-preview__setting",children:[e.jsx("label",{children:"Auto-Refresh:"}),e.jsxs("select",{value:m,onChange:g=>p(g.target.value),children:[e.jsx("option",{value:"0",children:"Manual only"}),e.jsx("option",{value:"5m",children:"Every 5 minutes"}),e.jsx("option",{value:"15m",children:"Every 15 minutes"}),e.jsx("option",{value:"30m",children:"Every 30 minutes"})]})]}),e.jsx("div",{className:"dashboard-preview__setting",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{children:"Allow users to change date range"})]})})]})]}),e.jsx(R,{onBack:f,onNext:b,nextLabel:"Save",backLabel:"Edit"})]})}function Ea(t){const a=[];return(!t||t.trim()==="")&&a.push("Dashboard name is required"),t.length>50&&a.push("Dashboard name must be 50 characters or less"),t.length<3&&a.push("Dashboard name must be at least 3 characters"),/[<>:"/\\|?*]/.test(t)&&a.push("Dashboard name contains invalid characters"),{isValid:a.length===0,errors:a}}class Ca{createFromRecipe(a,r,i,s){return{id:this.generateId(),name:a.name,description:a.description,recipeId:a.id,layout:i,modules:r,dateRange:{defaultPeriod:"30d",allowCustom:!0},groupsFilter:{enabled:!0},refreshInterval:300,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:s,isShared:!1}}createBlank(a,r,i,s){return{id:this.generateId(),name:a,layout:i,modules:r,dateRange:{defaultPeriod:"30d",allowCustom:!0},groupsFilter:{enabled:!0},refreshInterval:300,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:s,isShared:!1}}async saveDashboard(a,r){try{const i=this.getAllDashboards(),s=i.findIndex(n=>n.id===r.id);return s>=0?i[s]={...r,updatedAt:new Date().toISOString()}:i.push(r),localStorage.setItem("overviewBuilder.dashboards",JSON.stringify(i)),r.id}catch(i){throw console.error("Error saving dashboard:",i),new Error("Failed to save dashboard")}}getDashboardById(a){return this.getAllDashboards().find(i=>i.id===a)}getAllDashboards(){try{const a=localStorage.getItem("overviewBuilder.dashboards");return a?JSON.parse(a):[]}catch(a){return console.error("Error loading dashboards:",a),[]}}async deleteDashboard(a){const i=this.getAllDashboards().filter(s=>s.id!==a);localStorage.setItem("overviewBuilder.dashboards",JSON.stringify(i))}async updateDashboard(a){const r=this.getAllDashboards(),i=r.findIndex(s=>s.id===a.id);if(i>=0)r[i]={...a,updatedAt:new Date().toISOString()},localStorage.setItem("overviewBuilder.dashboards",JSON.stringify(r));else throw new Error("Dashboard not found")}generateId(){return`dashboard-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}const F=new Ca;function Da(){const{state:t}=y(),{credentials:a}=M(),{selectedRecipe:r,selectedModules:i,selectedLayout:s}=t,[n,o]=u.useState((r==null?void 0:r.name)||""),[l,c]=u.useState((r==null?void 0:r.description)||""),[d,h]=u.useState(!1),[m,p]=u.useState("private"),[_,f]=u.useState(!0),[b,k]=u.useState(!1),[g,I]=u.useState(!1),[S,j]=u.useState(null),[G,J]=u.useState(!1),E=Ea(n),Y=async()=>{if(!E.isValid){j(E.errors[0]);return}I(!0),j(null);try{const v=F.createFromRecipe(r,i,s,a.userName);v.name=n,v.description=l,v.isShared=d;const X=await F.saveDashboard(null,v);J(!0),setTimeout(()=>{console.log("Navigate to dashboard:",X)},2e3)}catch(v){j(v instanceof Error?v.message:"Failed to save dashboard")}finally{I(!1)}},Q=()=>{confirm("Are you sure? Your changes will be lost.")&&console.log("Cancelled")};return g?e.jsx(x,{message:"Saving your dashboard..."}):G?e.jsxs("div",{className:"save-dialog__success",children:[e.jsx("div",{className:"save-dialog__success-icon",children:"âœ“"}),e.jsx("h2",{className:"save-dialog__success-title",children:"Dashboard created successfully!"}),e.jsxs("p",{className:"save-dialog__success-message",children:["Your ",n," is ready to use"]}),e.jsxs("div",{className:"save-dialog__success-actions",children:[e.jsx("button",{className:"save-dialog__button save-dialog__button--primary",children:"View Dashboard"}),e.jsx("button",{className:"save-dialog__button",children:"Create Another"})]})]}):e.jsxs("div",{className:"save-dialog",children:[e.jsxs("div",{className:"save-dialog__header",children:[e.jsx("h2",{className:"save-dialog__title",children:"Save Dashboard"}),e.jsx("p",{className:"save-dialog__subtitle",children:"Give your dashboard a name"})]}),e.jsxs("div",{className:"save-dialog__form",children:[e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{htmlFor:"name",className:"save-dialog__label",children:"Dashboard Name *"}),e.jsx("input",{id:"name",type:"text",className:`save-dialog__input ${S?"save-dialog__input--error":""}`,value:n,onChange:v=>{o(v.target.value),j(null)},placeholder:"e.g., Safety Scorecard - Fleet Operations",maxLength:50}),S&&e.jsx("div",{className:"save-dialog__error",children:S}),e.jsxs("div",{className:"save-dialog__hint",children:[n.length,"/50 characters"]})]}),e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{htmlFor:"description",className:"save-dialog__label",children:"Description (optional)"}),e.jsx("textarea",{id:"description",className:"save-dialog__textarea",value:l,onChange:v=>c(v.target.value),placeholder:"Describe what this dashboard tracks...",rows:3,maxLength:200}),e.jsxs("div",{className:"save-dialog__hint",children:[l.length,"/200 characters"]})]}),e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{className:"save-dialog__label",children:"Sharing & Visibility"}),e.jsxs("div",{className:"save-dialog__options",children:[e.jsxs("label",{className:"save-dialog__radio",children:[e.jsx("input",{type:"radio",name:"sharing",value:"private",checked:m==="private",onChange:()=>{p("private"),h(!1)}}),e.jsx("span",{children:"Private (only me)"})]}),e.jsxs("label",{className:"save-dialog__radio",children:[e.jsx("input",{type:"radio",name:"sharing",value:"team",checked:m==="team",onChange:()=>{p("team"),h(!0)}}),e.jsx("span",{children:"Shared with my team"})]}),e.jsxs("label",{className:"save-dialog__radio",children:[e.jsx("input",{type:"radio",name:"sharing",value:"custom",checked:m==="custom",onChange:()=>{p("custom"),h(!0)}}),e.jsx("span",{children:"Shared with specific users/groups"})]})]})]}),e.jsxs("div",{className:"save-dialog__field",children:[e.jsx("label",{className:"save-dialog__label",children:"Menu Settings"}),e.jsxs("div",{className:"save-dialog__checkboxes",children:[e.jsxs("label",{className:"save-dialog__checkbox",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:v=>f(v.target.checked)}),e.jsx("span",{children:"Add to MyGeotab navigation menu"})]}),_&&e.jsxs("div",{className:"save-dialog__indent",children:[e.jsx("label",{htmlFor:"menu-location",children:"Location:"}),e.jsxs("select",{id:"menu-location",className:"save-dialog__select",children:[e.jsx("option",{value:"dashboards",children:"Dashboards"}),e.jsx("option",{value:"reports",children:"Reports"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("label",{className:"save-dialog__checkbox",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:v=>k(v.target.checked)}),e.jsx("span",{children:"Set as my default dashboard"})]}),b&&e.jsx("div",{className:"save-dialog__hint",children:"Opens automatically when you launch MyGeotab"})]})]})]}),e.jsxs("div",{className:"save-dialog__actions",children:[e.jsx("button",{className:"save-dialog__button",onClick:Q,children:"Cancel"}),e.jsx("button",{className:"save-dialog__button save-dialog__button--primary",onClick:Y,disabled:!E.isValid,children:"Save & Open"})]})]})}function Pa(){const{state:t}=y(),a={"recipe-picker":e.jsx(ta,{}),"module-selector":e.jsx(ra,{}),"layout-selector":e.jsx(da,{}),preview:e.jsx(Sa,{}),save:e.jsx(Da,{})},i=["recipe-picker","module-selector","layout-selector","preview","save"].indexOf(t.step);return e.jsxs("div",{className:"dashboard-wizard",children:[e.jsxs("div",{className:"dashboard-wizard__header",children:[e.jsx("h1",{className:"dashboard-wizard__title",children:"Create Dashboard"}),e.jsx(aa,{current:i+1,total:5})]}),e.jsx("div",{className:"dashboard-wizard__content",children:a[t.step]})]})}function Ma({api:t,state:a}){return e.jsx(ea,{children:e.jsx(ue,{api:t,state:a,children:e.jsx(Qe,{children:e.jsx(Ze,{children:e.jsx(Pa,{})})})})})}const Ra=new re({defaultOptions:{queries:{staleTime:5*60*1e3,cacheTime:10*60*1e3,refetchOnWindowFocus:!1,retry:1}}});window.OverviewBuilder={initialize:(t,a,r)=>{console.log("Initializing Overview-Builder Add-In");const i=document.getElementById("overview-builder-root");if(!i){console.error("Container element not found");return}P.createRoot(i).render(e.jsx(ae.StrictMode,{children:e.jsx(ie,{client:Ra,children:e.jsx(Ma,{api:t,state:a})})})),r()},focus:(t,a)=>{console.log("Overview-Builder focused")},blur:(t,a)=>{console.log("Overview-Builder blurred")}};
//# sourceMappingURL=index-01914cfa.js.map
